<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="./">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>SSH Key Setup for Remote Clusters &mdash; Clustrix Documentation</title>
    
    <link rel="stylesheet" type="text/css" href="_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=554e4187" />
            <link rel="index" title="Index" href="genindex.html" />
            <link rel="search" title="Search" href="search.html" />
            <link rel="top" title="Clustrix Documentation" href="#" />
            <link rel="next" title="SLURM Cluster Tutorial" href="tutorials/slurm_tutorial.html" />
            <link rel="prev" title="Installation" href="installation.html" />
    </head>
<body>
    <script type="text/javascript" src="_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="index.html"
                        title="Wagtail"
                        class="logo navbar-brand"
                    >
                        <img src="_static/img/wagtail-logo-circle.svg" width="45" height="59" alt="Wagtail"
                            class="logo-img"
                        />
                        Clustrix
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SSH Key Setup for Remote Clusters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tutorials/slurm_tutorial.html">SLURM Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/pbs_tutorial.html">PBS/Torque Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials/kubernetes_tutorial.html">Kubernetes Cluster Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interactive Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/complete_api_demo.html">Complete Clustrix API Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/slurm_tutorial.html">SLURM Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/pbs_tutorial.html">PBS/Torque Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/sge_tutorial.html">SGE (Sun Grid Engine) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/kubernetes_tutorial.html">Kubernetes Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/ssh_tutorial.html">SSH Remote Execution Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/basic_usage.html">Clustrix Basic Usage Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/decorator.html">Decorator API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/config.html">Configuration API</a></li>
<li class="toctree-l1"><a class="reference internal" href="api/local_executor.html">Local Executor API</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">SSH Key Setup for Remote Clusters</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/ContextLab/clustrixssh_setup.rst" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="_sources/ssh_setup.rst.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="ssh-key-setup-for-remote-clusters">
<h1>SSH Key Setup for Remote Clusters<a class="headerlink" href="#ssh-key-setup-for-remote-clusters" title="Link to this heading">¶</a></h1>
<p>Clustrix requires SSH access to remote clusters for job submission and management. This guide provides detailed instructions for setting up SSH keys with different cluster environments and authentication methods.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>Clustrix supports multiple authentication methods:</p>
<ul class="simple">
<li><p><strong>SSH Key Authentication</strong> (Recommended): Most secure and convenient</p></li>
<li><p><strong>Password Authentication</strong>: Simple but less secure</p></li>
<li><p><strong>SSH Agent</strong>: For multiple key management</p></li>
<li><p><strong>Custom Key Files</strong>: For specific cluster configurations</p></li>
</ul>
</section>
<section id="ssh-key-authentication-setup">
<h2>SSH Key Authentication Setup<a class="headerlink" href="#ssh-key-authentication-setup" title="Link to this heading">¶</a></h2>
<section id="generate-ssh-key-pair">
<h3>1. Generate SSH Key Pair<a class="headerlink" href="#generate-ssh-key-pair" title="Link to this heading">¶</a></h3>
<p>Generate a new SSH key pair specifically for cluster access:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate RSA key (recommended for compatibility)</span>
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-b<span class="w"> </span><span class="m">4096</span><span class="w"> </span>-f<span class="w"> </span>~/.ssh/clustrix_key

<span class="c1"># Or generate Ed25519 key (more secure, newer systems)</span>
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>ed25519<span class="w"> </span>-f<span class="w"> </span>~/.ssh/clustrix_ed25519
</pre></div>
</div>
<p><strong>Important</strong>: Use a strong passphrase for additional security.</p>
</section>
<section id="copy-public-key-to-cluster">
<h3>2. Copy Public Key to Cluster<a class="headerlink" href="#copy-public-key-to-cluster" title="Link to this heading">¶</a></h3>
<p>Upload your public key to the cluster:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using ssh-copy-id (easiest method)</span>
ssh-copy-id<span class="w"> </span>-i<span class="w"> </span>~/.ssh/clustrix_key.pub<span class="w"> </span>username@cluster.hostname.edu

<span class="c1"># Manual method if ssh-copy-id is not available</span>
cat<span class="w"> </span>~/.ssh/clustrix_key.pub<span class="w"> </span><span class="p">|</span><span class="w"> </span>ssh<span class="w"> </span>username@cluster.hostname.edu<span class="w"> </span><span class="s2">&quot;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&quot;</span>
</pre></div>
</div>
</section>
<section id="configure-ssh-client">
<h3>3. Configure SSH Client<a class="headerlink" href="#configure-ssh-client" title="Link to this heading">¶</a></h3>
<p>Create or edit <code class="docutils literal notranslate"><span class="pre">~/.ssh/config</span></code> to define cluster-specific settings:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Example SSH config for a SLURM cluster
Host my-slurm-cluster
    HostName slurm.university.edu
    User myusername
    IdentityFile ~/.ssh/clustrix_key
    ForwardAgent yes
    ServerAliveInterval 60
    ServerAliveCountMax 3

# Example for a PBS cluster with specific port
Host my-pbs-cluster
    HostName pbs.cluster.org
    Port 2222
    User researcher
    IdentityFile ~/.ssh/clustrix_key
    ProxyJump gateway.cluster.org

# Example for SGE cluster with compression
Host my-sge-cluster
    HostName sge.hpc.gov
    User scientist
    IdentityFile ~/.ssh/clustrix_key
    Compression yes
    TCPKeepAlive yes
</pre></div>
</div>
</section>
<section id="test-ssh-connection">
<h3>4. Test SSH Connection<a class="headerlink" href="#test-ssh-connection" title="Link to this heading">¶</a></h3>
<p>Verify your SSH setup works correctly:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test basic connection</span>
ssh<span class="w"> </span>my-slurm-cluster<span class="w"> </span><span class="s2">&quot;hostname &amp;&amp; whoami&quot;</span>

<span class="c1"># Test specific commands that Clustrix will use</span>
ssh<span class="w"> </span>my-slurm-cluster<span class="w"> </span><span class="s2">&quot;which sbatch &amp;&amp; squeue --version&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="clustrix-configuration">
<h2>Clustrix Configuration<a class="headerlink" href="#clustrix-configuration" title="Link to this heading">¶</a></h2>
<p>Configure Clustrix to use your SSH setup:</p>
<section id="python-configuration">
<h3>Python Configuration<a class="headerlink" href="#python-configuration" title="Link to this heading">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">clustrix</span> <span class="kn">import</span> <span class="n">configure</span>

<span class="c1"># Using SSH config host alias (recommended)</span>
<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;my-slurm-cluster&quot;</span><span class="p">,</span>  <span class="c1"># matches SSH config</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span><span class="p">,</span>           <span class="c1"># optional if in SSH config</span>
<span class="p">)</span>

<span class="c1"># Using specific key file</span>
<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;pbs&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;pbs.cluster.org&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;researcher&quot;</span><span class="p">,</span>
    <span class="n">key_file</span><span class="o">=</span><span class="s2">&quot;~/.ssh/clustrix_key&quot;</span>
<span class="p">)</span>

<span class="c1"># Using password authentication (not recommended)</span>
<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;sge&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;sge.hpc.gov&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;scientist&quot;</span><span class="p">,</span>
    <span class="n">password</span><span class="o">=</span><span class="s2">&quot;your_password&quot;</span>  <span class="c1"># Use environment variable instead</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="configuration-file">
<h3>Configuration File<a class="headerlink" href="#configuration-file" title="Link to this heading">¶</a></h3>
<p>Create <code class="docutils literal notranslate"><span class="pre">~/.clustrix/config.yml</span></code>:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># SLURM cluster with SSH key</span>
<span class="nt">cluster_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;slurm&quot;</span>
<span class="nt">cluster_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-slurm-cluster&quot;</span>
<span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myusername&quot;</span>
<span class="nt">key_file</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;~/.ssh/clustrix_key&quot;</span>
<span class="nt">remote_work_dir</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/scratch/myusername/clustrix&quot;</span>

<span class="c1"># Default resource settings</span>
<span class="nt">default_cores</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="nt">default_memory</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8GB&quot;</span>
<span class="nt">default_time</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;02:00:00&quot;</span>

<span class="c1"># Environment setup</span>
<span class="nt">module_loads</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;python/3.11&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;gcc/11.2&quot;</span>

<span class="nt">environment_variables</span><span class="p">:</span>
<span class="w">  </span><span class="nt">OMP_NUM_THREADS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
</pre></div>
</div>
</section>
<section id="environment-variables">
<h3>Environment Variables<a class="headerlink" href="#environment-variables" title="Link to this heading">¶</a></h3>
<p>Set environment variables for sensitive information:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># In your shell profile (~/.bashrc, ~/.zshrc)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CLUSTRIX_HOST</span><span class="o">=</span><span class="s2">&quot;slurm.university.edu&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CLUSTRIX_USERNAME</span><span class="o">=</span><span class="s2">&quot;myusername&quot;</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CLUSTRIX_KEY_FILE</span><span class="o">=</span><span class="s2">&quot;~/.ssh/clustrix_key&quot;</span>

<span class="c1"># For password auth (not recommended in scripts)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">CLUSTRIX_PASSWORD</span><span class="o">=</span><span class="s2">&quot;your_password&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-ssh-configurations">
<h2>Advanced SSH Configurations<a class="headerlink" href="#advanced-ssh-configurations" title="Link to this heading">¶</a></h2>
<section id="ssh-agent-integration">
<h3>SSH Agent Integration<a class="headerlink" href="#ssh-agent-integration" title="Link to this heading">¶</a></h3>
<p>For managing multiple keys and passphrases:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Start SSH agent</span>
<span class="nb">eval</span><span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>ssh-agent<span class="w"> </span>-s<span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># Add your cluster key</span>
ssh-add<span class="w"> </span>~/.ssh/clustrix_key

<span class="c1"># Verify keys are loaded</span>
ssh-add<span class="w"> </span>-l
</pre></div>
</div>
<p>Configure Clustrix to use SSH agent:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;my-cluster&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;myuser&quot;</span>
    <span class="c1"># No key_file specified - will use SSH agent</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="jump-hosts-and-bastion-servers">
<h3>Jump Hosts and Bastion Servers<a class="headerlink" href="#jump-hosts-and-bastion-servers" title="Link to this heading">¶</a></h3>
<p>For clusters behind firewalls:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># SSH config with jump host
Host cluster-gateway
    HostName gateway.cluster.org
    User myuser
    IdentityFile ~/.ssh/gateway_key

Host cluster-internal
    HostName internal.cluster.local
    User myuser
    IdentityFile ~/.ssh/cluster_key
    ProxyJump cluster-gateway
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Clustrix configuration for jump host setup</span>
<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;cluster-internal&quot;</span><span class="p">,</span>  <span class="c1"># Uses SSH config</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;myuser&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="multiple-cluster-management">
<h3>Multiple Cluster Management<a class="headerlink" href="#multiple-cluster-management" title="Link to this heading">¶</a></h3>
<p>Manage multiple clusters with different keys:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define cluster configurations</span>
<span class="n">clusters</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;slurm_cluster&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;cluster_type&quot;</span><span class="p">:</span> <span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cluster_host&quot;</span><span class="p">:</span> <span class="s2">&quot;slurm.university.edu&quot;</span><span class="p">,</span>
        <span class="s2">&quot;key_file&quot;</span><span class="p">:</span> <span class="s2">&quot;~/.ssh/slurm_key&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;pbs_cluster&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;cluster_type&quot;</span><span class="p">:</span> <span class="s2">&quot;pbs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cluster_host&quot;</span><span class="p">:</span> <span class="s2">&quot;pbs.research.org&quot;</span><span class="p">,</span>
        <span class="s2">&quot;key_file&quot;</span><span class="p">:</span> <span class="s2">&quot;~/.ssh/pbs_key&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Switch between clusters</span>
<span class="kn">from</span> <span class="nn">clustrix</span> <span class="kn">import</span> <span class="n">configure</span>

<span class="c1"># Use SLURM cluster</span>
<span class="n">configure</span><span class="p">(</span><span class="o">**</span><span class="n">clusters</span><span class="p">[</span><span class="s2">&quot;slurm_cluster&quot;</span><span class="p">])</span>

<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">slurm_task</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Running on SLURM&quot;</span>

<span class="c1"># Switch to PBS cluster</span>
<span class="n">configure</span><span class="p">(</span><span class="o">**</span><span class="n">clusters</span><span class="p">[</span><span class="s2">&quot;pbs_cluster&quot;</span><span class="p">])</span>

<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">pbs_task</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Running on PBS&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="security-best-practices">
<h2>Security Best Practices<a class="headerlink" href="#security-best-practices" title="Link to this heading">¶</a></h2>
<section id="key-management">
<h3>Key Management<a class="headerlink" href="#key-management" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Use Strong Passphrases</strong>: Always protect private keys with passphrases</p></li>
<li><p><strong>Separate Keys per Cluster</strong>: Use different keys for different environments</p></li>
<li><p><strong>Regular Key Rotation</strong>: Replace keys periodically (every 6-12 months)</p></li>
<li><p><strong>Backup Keys Securely</strong>: Store encrypted backups of important keys</p></li>
</ol>
</section>
<section id="file-permissions">
<h3>File Permissions<a class="headerlink" href="#file-permissions" title="Link to this heading">¶</a></h3>
<p>Ensure correct SSH file permissions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set correct permissions</span>
chmod<span class="w"> </span><span class="m">700</span><span class="w"> </span>~/.ssh
chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>~/.ssh/config
chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>~/.ssh/clustrix_key
chmod<span class="w"> </span><span class="m">644</span><span class="w"> </span>~/.ssh/clustrix_key.pub
chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>~/.ssh/authorized_keys<span class="w">  </span><span class="c1"># on remote cluster</span>
</pre></div>
</div>
</section>
<section id="network-security">
<h3>Network Security<a class="headerlink" href="#network-security" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Use SSH Config</strong>: Centralize connection settings</p></li>
<li><p><strong>Enable Compression</strong>: For large data transfers</p></li>
<li><p><strong>Configure Timeouts</strong>: Prevent hanging connections</p></li>
<li><p><strong>Use Port Forwarding</strong>: For additional services when needed</p></li>
</ol>
</section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">¶</a></h2>
<section id="common-issues">
<h3>Common Issues<a class="headerlink" href="#common-issues" title="Link to this heading">¶</a></h3>
<p><strong>Connection Refused</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check if SSH service is running</span>
ssh<span class="w"> </span>-v<span class="w"> </span>username@cluster.hostname.edu

<span class="c1"># Test different ports</span>
ssh<span class="w"> </span>-p<span class="w"> </span><span class="m">2222</span><span class="w"> </span>username@cluster.hostname.edu
</pre></div>
</div>
<p><strong>Permission Denied</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Verify key permissions</span>
ls<span class="w"> </span>-la<span class="w"> </span>~/.ssh/

<span class="c1"># Check authorized_keys on remote</span>
ssh<span class="w"> </span>username@cluster.hostname.edu<span class="w"> </span><span class="s2">&quot;ls -la ~/.ssh/authorized_keys&quot;</span>

<span class="c1"># Debug SSH connection</span>
ssh<span class="w"> </span>-vvv<span class="w"> </span>username@cluster.hostname.edu
</pre></div>
</div>
<p><strong>Clustrix Connection Errors</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test Clustrix SSH connection</span>
<span class="kn">from</span> <span class="nn">clustrix.executor</span> <span class="kn">import</span> <span class="n">ClusterExecutor</span>
<span class="kn">from</span> <span class="nn">clustrix.config</span> <span class="kn">import</span> <span class="n">get_config</span>

<span class="n">config</span> <span class="o">=</span> <span class="n">get_config</span><span class="p">()</span>
<span class="n">executor</span> <span class="o">=</span> <span class="n">ClusterExecutor</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">executor</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SSH connection successful!&quot;</span><span class="p">)</span>
    <span class="n">executor</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Connection failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Debug Mode</strong></p>
<p>Enable verbose logging for troubleshooting:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">clustrix</span> <span class="kn">import</span> <span class="n">configure</span><span class="p">,</span> <span class="n">cluster</span>

<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;my-cluster&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;myuser&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="cluster-specific-setup">
<h2>Cluster-Specific Setup<a class="headerlink" href="#cluster-specific-setup" title="Link to this heading">¶</a></h2>
<section id="slurm-clusters">
<h3>SLURM Clusters<a class="headerlink" href="#slurm-clusters" title="Link to this heading">¶</a></h3>
<p>Typical SLURM cluster requirements:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;slurm.hpc.edu&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;researcher&quot;</span><span class="p">,</span>
    <span class="n">key_file</span><span class="o">=</span><span class="s2">&quot;~/.ssh/slurm_key&quot;</span><span class="p">,</span>
    <span class="n">remote_work_dir</span><span class="o">=</span><span class="s2">&quot;/scratch/researcher/jobs&quot;</span><span class="p">,</span>
    <span class="n">module_loads</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;python/3.11&quot;</span><span class="p">,</span> <span class="s2">&quot;gcc/11&quot;</span><span class="p">],</span>
    <span class="n">default_partition</span><span class="o">=</span><span class="s2">&quot;compute&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="pbs-torque-clusters">
<h3>PBS/Torque Clusters<a class="headerlink" href="#pbs-torque-clusters" title="Link to this heading">¶</a></h3>
<p>PBS cluster configuration:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;pbs&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;pbs.cluster.org&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;scientist&quot;</span><span class="p">,</span>
    <span class="n">key_file</span><span class="o">=</span><span class="s2">&quot;~/.ssh/pbs_key&quot;</span><span class="p">,</span>
    <span class="n">remote_work_dir</span><span class="o">=</span><span class="s2">&quot;/home/scientist/clustrix&quot;</span><span class="p">,</span>
    <span class="n">default_queue</span><span class="o">=</span><span class="s2">&quot;normal&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="sge-clusters">
<h3>SGE Clusters<a class="headerlink" href="#sge-clusters" title="Link to this heading">¶</a></h3>
<p>Sun Grid Engine setup:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;sge&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;sge.grid.edu&quot;</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;user&quot;</span><span class="p">,</span>
    <span class="n">key_file</span><span class="o">=</span><span class="s2">&quot;~/.ssh/sge_key&quot;</span><span class="p">,</span>
    <span class="n">remote_work_dir</span><span class="o">=</span><span class="s2">&quot;/tmp/user/clustrix&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="complete-example">
<h2>Complete Example<a class="headerlink" href="#complete-example" title="Link to this heading">¶</a></h2>
<p>Here’s a complete working example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Generate SSH key</span>
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-b<span class="w"> </span><span class="m">4096</span><span class="w"> </span>-f<span class="w"> </span>~/.ssh/my_cluster_key

<span class="c1"># 2. Copy to cluster</span>
ssh-copy-id<span class="w"> </span>-i<span class="w"> </span>~/.ssh/my_cluster_key.pub<span class="w"> </span>myuser@cluster.university.edu

<span class="c1"># 3. Create SSH config</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Host my-cluster</span>
<span class="s2">    HostName cluster.university.edu</span>
<span class="s2">    User myuser</span>
<span class="s2">    IdentityFile ~/.ssh/my_cluster_key&quot;</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.ssh/config

<span class="c1"># 4. Test connection</span>
ssh<span class="w"> </span>my-cluster<span class="w"> </span><span class="s2">&quot;hostname&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># 5. Configure Clustrix</span>
<span class="kn">from</span> <span class="nn">clustrix</span> <span class="kn">import</span> <span class="n">configure</span><span class="p">,</span> <span class="n">cluster</span>

<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;slurm&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="s2">&quot;my-cluster&quot;</span><span class="p">,</span>
    <span class="n">remote_work_dir</span><span class="o">=</span><span class="s2">&quot;/scratch/myuser/clustrix&quot;</span>
<span class="p">)</span>

<span class="c1"># 6. Use Clustrix</span>
<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;8GB&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">compute_task</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">i</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="c1"># This will execute on the remote cluster</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">compute_task</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Result: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This setup provides secure, reliable SSH access for Clustrix to manage your cluster computing jobs.</p>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="installation.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>Installation
    </a>
    <a class="float-right" href="tutorials/slurm_tutorial.html" title="Next">
        SLURM Cluster Tutorial <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">SSH Key Setup for Remote Clusters</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#ssh-key-authentication-setup">SSH Key Authentication Setup</a><ul>
<li><a class="reference internal" href="#generate-ssh-key-pair">1. Generate SSH Key Pair</a></li>
<li><a class="reference internal" href="#copy-public-key-to-cluster">2. Copy Public Key to Cluster</a></li>
<li><a class="reference internal" href="#configure-ssh-client">3. Configure SSH Client</a></li>
<li><a class="reference internal" href="#test-ssh-connection">4. Test SSH Connection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#clustrix-configuration">Clustrix Configuration</a><ul>
<li><a class="reference internal" href="#python-configuration">Python Configuration</a></li>
<li><a class="reference internal" href="#configuration-file">Configuration File</a></li>
<li><a class="reference internal" href="#environment-variables">Environment Variables</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-ssh-configurations">Advanced SSH Configurations</a><ul>
<li><a class="reference internal" href="#ssh-agent-integration">SSH Agent Integration</a></li>
<li><a class="reference internal" href="#jump-hosts-and-bastion-servers">Jump Hosts and Bastion Servers</a></li>
<li><a class="reference internal" href="#multiple-cluster-management">Multiple Cluster Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-best-practices">Security Best Practices</a><ul>
<li><a class="reference internal" href="#key-management">Key Management</a></li>
<li><a class="reference internal" href="#file-permissions">File Permissions</a></li>
<li><a class="reference internal" href="#network-security">Network Security</a></li>
</ul>
</li>
<li><a class="reference internal" href="#troubleshooting">Troubleshooting</a><ul>
<li><a class="reference internal" href="#common-issues">Common Issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cluster-specific-setup">Cluster-Specific Setup</a><ul>
<li><a class="reference internal" href="#slurm-clusters">SLURM Clusters</a></li>
<li><a class="reference internal" href="#pbs-torque-clusters">PBS/Torque Clusters</a></li>
<li><a class="reference internal" href="#sge-clusters">SGE Clusters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#complete-example">Complete Example</a></li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="PyPI">GitHub</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2025, Contextual Dynamics Laboratory
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>
                    Created using
                    <a class="text-white" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.5.0
                    </a>
                    and
                    <a class="text-white" href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 8.1.3
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=9bcbadda"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script type="text/javascript" src="_static/dist/theme.js"></script>
        <script type="text/javascript" src="_static/dist/vendor.js"></script>
        <script type="text/javascript" src="_static/searchtools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>