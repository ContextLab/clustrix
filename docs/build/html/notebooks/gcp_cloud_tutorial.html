<!DOCTYPE html>
<html class="no-js" lang="en" data-content_root="../">
<head>
    <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    
        <title>Google Cloud Platform (GCP) Tutorial &mdash; Clustrix Documentation</title>
    
    <link rel="stylesheet" type="text/css" href="../_static/dist/fontawesome.css" />
      <link rel="stylesheet" type="text/css" href="../_static/dist/theme.css?v=310cf088" />
      <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=554e4187" />
            <link rel="index" title="Index" href="../genindex.html" />
            <link rel="search" title="Search" href="../search.html" />
            <link rel="top" title="Clustrix Documentation" href="#" />
            <link rel="next" title="HuggingFace Spaces Tutorial" href="huggingface_spaces_tutorial.html" />
            <link rel="prev" title="Microsoft Azure Cloud Tutorial" href="azure_cloud_tutorial.html" />
    </head>
<body>
    <script type="text/javascript" src="../_static/dist/blocking.js"></script>
    <header class="container-fluid bg-primary">
        <a class="btn btn-sm btn-light skip-to-content-link" href="#main">Skip to content</a>
        <div class="container-fluid">
            <div class="navbar navbar-expand-lg navbar-dark font-weight-bold">
                    <a href="../index.html"
                        title="Wagtail"
                        class="logo navbar-brand"
                    >
                        <img src="../_static/img/wagtail-logo-circle.svg" width="45" height="59" alt="Wagtail"
                            class="logo-img"
                        />
                        Clustrix
                    </a>
                
                
                <button class="navbar-toggler btn btn-primary d-lg-none" type="button" data-toggle="collapse" data-target="#collapseSidebar" aria-expanded="false" aria-controls="collapseExample">
                    <span class="navbar-toggler-icon"></span>
                    <span class="sr-only">menu</span>
                </button>
            </div>
        </div>
    </header>
    <div class="container-fluid">
        <div class="row">
            <aside class="col-12 col-lg-3 sidebar-container">
                <div id="collapseSidebar" class="collapse sticky-top d-lg-block pt-5 pr-lg-4">
<div id="searchbox" class="searchbox mb-6 px-1" role="search">
    <form id="search-form" action="../search.html" autocomplete="off" method="get" role="search">
        <div class="input-group">
            <div class="input-group-prepend">
                <div class="input-group-text border-right-0 bg-white py-3 pl-3 pr-2"><span class="fas fa-search"></span></div>
            </div>
            <input class="form-control py-3 pr-3 pl-1 h-100 border-left-0" type="search" name="q" placeholder="Search documentation" aria-label="Search documentation" id="searchinput" />
        </div>
        <input type="hidden" name="check_keywords" value="yes" />
        <input type="hidden" name="area" value="default" />
    </form>
</div><div class="site-toc">
    <nav class="toc mt-3" aria-label="Main menu">
        <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ssh_setup.html">SSH Key Setup for Remote Clusters</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/slurm_tutorial.html">SLURM Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/pbs_tutorial.html">PBS/Torque Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/kubernetes_tutorial.html">Kubernetes Cluster Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interactive Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="cluster_config_example.html">Clustrix Configuration Manager Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="complete_api_demo.html">Complete Clustrix API Demonstration</a></li>
<li class="toctree-l1"><a class="reference internal" href="slurm_tutorial.html">SLURM Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="pbs_tutorial.html">PBS/Torque Cluster Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="sge_tutorial.html">SGE (Sun Grid Engine) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="kubernetes_tutorial.html">Kubernetes Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="ssh_tutorial.html">SSH Remote Execution Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_usage.html">Clustrix Basic Usage Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Cloud Platform Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="aws_cloud_tutorial.html">Amazon Web Services (AWS) Cloud Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="azure_cloud_tutorial.html">Microsoft Azure Cloud Tutorial</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Google Cloud Platform (GCP) Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="huggingface_spaces_tutorial.html">HuggingFace Spaces Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="lambda_cloud_tutorial.html">Lambda Cloud Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="cost_monitoring_tutorial.html">Cloud Cost Monitoring and Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/decorator.html">Decorator API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/config.html">Configuration API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/notebook_magic.html">Notebook Magic Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/cost_monitoring.html">Cost Monitoring</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/local_executor.html">Local Executor API</a></li>
</ul>

    </nav>
    <template data-toggle-item-template>
        <button class="btn btn-sm btn-link toctree-expand" type="button">
            <span class="sr-only">Toggle menu contents</span>
        </button>
    </template>
</div>
                    <div class="d-lg-none border-bottom">
                        
                    </div>
                </div>
            </aside>
            <div class="col-12 col-lg-9 pt-5">
                <header class="row align-items-baseline">
                    <div class="col">
                        <nav aria-label="breadcrumb">
    <ol class="breadcrumb m-0 p-0 bg-transparent">
        <li class="breadcrumb-item"><a href="../index.html">Docs</a></li>
        <li class="breadcrumb-item active" aria-current="page">Google Cloud Platform (GCP) Tutorial</li>
    </ol>
</nav>
                    </div>
                    <div class="col-sm-12 col-lg-auto mt-3 mt-lg-3">
                        <noscript>
                            <p>JavaScript is required to toggle light/dark mode..</p>
                        </noscript>
                        <button id="wagtail-theme" class="btn btn-sm btn-light text-decoration-none" type="button">
                            <span class="dark-only"><i class="fas fa-sun"></i> Light mode</span>
                            <span class="light-only"><i class="fas fa-moon"></i> Dark mode</span>
                        </button>
    <a class="btn btn-sm btn-light text-decoration-none" href="https://github.com/ContextLab/clustrix/blob/master/docs/source/notebooks/gcp_cloud_tutorial.ipynb" rel="nofollow">
        <span class="btn-icon"><span class="fab fa-github"></span></span>
        <span class="btn-text">Edit on GitHub</span>
    </a>
    <a class="btn btn-sm btn-light text-decoration-none" href="../_sources/notebooks/gcp_cloud_tutorial.ipynb.txt" rel="nofollow">
        <span class="btn-icon"><span class="fas fa-code"></span></span>
        <span class="btn-text">View source</span>
    </a>
                        
                    </div>
                </header>
                <div class="row" >
                    <div class="col-12">
                        <hr class="w-100 my-4">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-9 order-last order-lg-first rst-content">
                        <main role="main" id="main">
    <section id="Google-Cloud-Platform-(GCP)-Tutorial">
<h1>Google Cloud Platform (GCP) Tutorial<a class="headerlink" href="#Google-Cloud-Platform-(GCP)-Tutorial" title="Link to this heading">¶</a></h1>
<p>This tutorial demonstrates how to use Clustrix with Google Cloud Platform (GCP) infrastructure for scalable distributed computing.</p>
<p><a class="reference external" href="https://colab.research.google.com/github/ContextLab/clustrix/blob/master/docs/source/notebooks/gcp_cloud_tutorial.ipynb"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<section id="Overview">
<h2>Overview<a class="headerlink" href="#Overview" title="Link to this heading">¶</a></h2>
<p>GCP provides several services that integrate well with Clustrix:</p>
<ul class="simple">
<li><p><strong>Compute Engine</strong>: Virtual machines for compute clusters</p></li>
<li><p><strong>Google Kubernetes Engine (GKE)</strong>: Managed Kubernetes clusters</p></li>
<li><p><strong>Batch</strong>: Managed job scheduling service</p></li>
<li><p><strong>Cloud Run</strong>: Serverless container platform</p></li>
<li><p><strong>Vertex AI</strong>: Machine learning platform</p></li>
<li><p><strong>Cloud Storage</strong>: Object storage for data and results</p></li>
<li><p><strong>VPC</strong>: Network isolation and security</p></li>
<li><p><strong>Preemptible VMs</strong>: Cost-effective compute instances</p></li>
</ul>
</section>
<section id="Complete-Setup-Guide-from-Scratch">
<h2>Complete Setup Guide from Scratch<a class="headerlink" href="#Complete-Setup-Guide-from-Scratch" title="Link to this heading">¶</a></h2>
<section id="Step-1:-Google-Cloud-Account-Setup">
<h3>Step 1: Google Cloud Account Setup<a class="headerlink" href="#Step-1:-Google-Cloud-Account-Setup" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p><strong>Create Google Cloud Account</strong>:</p>
<ul class="simple">
<li><p>Go to <a class="reference external" href="https://console.cloud.google.com/">Google Cloud Console</a></p></li>
<li><p>Sign up with your Google account or create a new one</p></li>
<li><p>Accept the terms of service</p></li>
</ul>
</li>
<li><p><strong>Enable Billing</strong>:</p>
<ul class="simple">
<li><p>Navigate to Billing in the Google Cloud Console</p></li>
<li><p>Create a billing account and add a payment method</p></li>
<li><p><strong>Important</strong>: New users get $300 in free credits</p></li>
<li><p>Set up billing alerts to avoid unexpected charges</p></li>
</ul>
</li>
<li><p><strong>Create a New Project</strong>:</p>
<ul class="simple">
<li><p>Go to the Project Selector in the console</p></li>
<li><p>Click “New Project”</p></li>
<li><p>Choose a unique project ID (e.g., <code class="docutils literal notranslate"><span class="pre">my-clustrix-project-123</span></code>)</p></li>
<li><p>Enable billing for this project</p></li>
</ul>
</li>
</ol>
</section>
<section id="Step-2:-Install-Google-Cloud-SDK-(gcloud-CLI)">
<h3>Step 2: Install Google Cloud SDK (gcloud CLI)<a class="headerlink" href="#Step-2:-Install-Google-Cloud-SDK-(gcloud-CLI)" title="Link to this heading">¶</a></h3>
<p><strong>On macOS:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using Homebrew (recommended)</span>
brew<span class="w"> </span>install<span class="w"> </span>google-cloud-sdk

<span class="c1"># Or download installer</span>
curl<span class="w"> </span>https://sdk.cloud.google.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
<span class="nb">exec</span><span class="w"> </span>-l<span class="w"> </span><span class="nv">$SHELL</span>
</pre></div>
</div>
<p><strong>On Linux:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download and install</span>
curl<span class="w"> </span>https://sdk.cloud.google.com<span class="w"> </span><span class="p">|</span><span class="w"> </span>bash
<span class="nb">exec</span><span class="w"> </span>-l<span class="w"> </span><span class="nv">$SHELL</span>

<span class="c1"># Or use package manager (Ubuntu/Debian)</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>google-cloud-sdk
</pre></div>
</div>
<p><strong>On Windows:</strong></p>
<ul class="simple">
<li><p>Download the installer from <a class="reference external" href="https://cloud.google.com/sdk/docs/install">Google Cloud SDK page</a></p></li>
<li><p>Run the installer and follow instructions</p></li>
</ul>
</section>
<section id="Step-3:-Enable-Required-APIs">
<h3>Step 3: Enable Required APIs<a class="headerlink" href="#Step-3:-Enable-Required-APIs" title="Link to this heading">¶</a></h3>
<p>Enable the necessary Google Cloud APIs for this tutorial:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set your project ID</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">PROJECT_ID</span><span class="o">=</span><span class="s2">&quot;your-project-id-here&quot;</span>
gcloud<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>project<span class="w"> </span><span class="nv">$PROJECT_ID</span>

<span class="c1"># Enable required APIs</span>
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>compute.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>container.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>batch.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>aiplatform.googleapis.com
gcloud<span class="w"> </span>services<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>storage.googleapis.com
</pre></div>
</div>
</section>
</section>
<section id="Prerequisites-Checklist">
<h2>Prerequisites Checklist<a class="headerlink" href="#Prerequisites-Checklist" title="Link to this heading">¶</a></h2>
<p>Before proceeding, ensure you have:</p>
<ul class="simple">
<li><p>☐ Google Cloud account with billing enabled</p></li>
<li><p>☐ Google Cloud project created</p></li>
<li><p>☐ Google Cloud SDK (gcloud) installed locally</p></li>
<li><p>☐ Required APIs enabled (compute, container, batch, storage, aiplatform)</p></li>
<li><p>☐ SSH key pair for VM access (we’ll create this below)</p></li>
<li><p>☐ Basic understanding of command line usage</p></li>
</ul>
</section>
<section id="Installation-and-Setup">
<h2>Installation and Setup<a class="headerlink" href="#Installation-and-Setup" title="Link to this heading">¶</a></h2>
<p>Install Clustrix with GCP dependencies:</p>
<section id="Step-4:-SSH-Key-Setup">
<h3>Step 4: SSH Key Setup<a class="headerlink" href="#Step-4:-SSH-Key-Setup" title="Link to this heading">¶</a></h3>
<p>Create SSH keys for secure access to your GCP instances:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate SSH key pair (if you don&#39;t have one)</span>
ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-b<span class="w"> </span><span class="m">4096</span><span class="w"> </span>-C<span class="w"> </span><span class="s2">&quot;your-email@example.com&quot;</span><span class="w"> </span>-f<span class="w"> </span>~/.ssh/gcp_key

<span class="c1"># Add the public key to GCP</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>os-login<span class="w"> </span>ssh-keys<span class="w"> </span>add<span class="w"> </span>--key-file<span class="o">=</span>~/.ssh/gcp_key.pub

<span class="c1"># Or add to project metadata (alternative method)</span>
gcloud<span class="w"> </span>compute<span class="w"> </span>project-info<span class="w"> </span>add-metadata<span class="w"> </span>--metadata-from-file<span class="w"> </span>ssh-keys<span class="o">=</span>~/.ssh/gcp_key.pub
</pre></div>
</div>
<p><strong>Note</strong>: If you’re using Google Cloud Shell, SSH keys are automatically managed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install Clustrix with GCP support</span>
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>clustrix<span class="w"> </span>google-cloud-compute<span class="w"> </span>google-cloud-storage<span class="w"> </span>google-auth<span class="w"> </span>google-auth-oauthlib

<span class="c1"># Import required libraries</span>
<span class="kn">import</span> <span class="nn">clustrix</span>
<span class="kn">from</span> <span class="nn">clustrix</span> <span class="kn">import</span> <span class="n">cluster</span><span class="p">,</span> <span class="n">configure</span>
<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">compute_v1</span>
<span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">storage</span>
<span class="kn">from</span> <span class="nn">google.auth</span> <span class="kn">import</span> <span class="n">default</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">json</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="GCP-Authentication-Setup">
<h2>GCP Authentication Setup<a class="headerlink" href="#GCP-Authentication-Setup" title="Link to this heading">¶</a></h2>
<p>Configure your GCP credentials. Choose the method that best fits your environment:</p>
<section id="Option-1:-gcloud-CLI-Authentication-(Recommended-for-Local-Development)">
<h3>Option 1: gcloud CLI Authentication (Recommended for Local Development)<a class="headerlink" href="#Option-1:-gcloud-CLI-Authentication-(Recommended-for-Local-Development)" title="Link to this heading">¶</a></h3>
<p>This method uses your personal Google account credentials:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Initial authentication and project setup</span>
<span class="o">!</span>gcloud<span class="w"> </span>auth<span class="w"> </span>login
<span class="o">!</span>gcloud<span class="w"> </span>auth<span class="w"> </span>application-default<span class="w"> </span>login

<span class="c1"># Set your project ID (replace with your actual project ID)</span>
<span class="n">PROJECT_ID</span> <span class="o">=</span> <span class="s2">&quot;your-project-id-here&quot;</span>  <span class="c1"># Replace this!</span>
<span class="o">!</span>gcloud<span class="w"> </span>config<span class="w"> </span><span class="nb">set</span><span class="w"> </span>project<span class="w"> </span><span class="o">{</span>PROJECT_ID<span class="o">}</span>

<span class="c1"># Verify authentication and project setup</span>
<span class="o">!</span>gcloud<span class="w"> </span>auth<span class="w"> </span>list
<span class="o">!</span>gcloud<span class="w"> </span>config<span class="w"> </span>get-value<span class="w"> </span>project
<span class="o">!</span>gcloud<span class="w"> </span>projects<span class="w"> </span>describe<span class="w"> </span><span class="o">{</span>PROJECT_ID<span class="o">}</span>
</pre></div>
</div>
</div>
</section>
<section id="Option-2:-Service-Account-Authentication-(Recommended-for-Production)">
<h3>Option 2: Service Account Authentication (Recommended for Production)<a class="headerlink" href="#Option-2:-Service-Account-Authentication-(Recommended-for-Production)" title="Link to this heading">¶</a></h3>
<p>For production environments, create and use a service account with specific permissions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Test GCP connection</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">credentials</span><span class="p">,</span> <span class="n">project_id</span> <span class="o">=</span> <span class="n">default</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Successfully authenticated with project: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Test compute API</span>
    <span class="n">compute_client</span> <span class="o">=</span> <span class="n">compute_v1</span><span class="o">.</span><span class="n">InstancesClient</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Compute Engine API access confirmed&quot;</span><span class="p">)</span>

    <span class="c1"># Test storage API</span>
    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Cloud Storage API access confirmed&quot;</span><span class="p">)</span>

<span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ GCP authentication failed: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Please check your authentication setup and try again.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Service Account Setup (Production Environments)</strong></p>
<p>For production use, create a service account with specific permissions:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create service account</span>
gcloud<span class="w"> </span>iam<span class="w"> </span>service-accounts<span class="w"> </span>create<span class="w"> </span>clustrix-service-account<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--description<span class="o">=</span><span class="s2">&quot;Service account for Clustrix operations&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--display-name<span class="o">=</span><span class="s2">&quot;Clustrix Service Account&quot;</span>

<span class="c1"># Grant necessary permissions</span>
gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span>YOUR_PROJECT_ID<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--member<span class="o">=</span><span class="s2">&quot;serviceAccount:clustrix-service-account@YOUR_PROJECT_ID.iam.gserviceaccount.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--role<span class="o">=</span><span class="s2">&quot;roles/compute.admin&quot;</span>

gcloud<span class="w"> </span>projects<span class="w"> </span>add-iam-policy-binding<span class="w"> </span>YOUR_PROJECT_ID<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--member<span class="o">=</span><span class="s2">&quot;serviceAccount:clustrix-service-account@YOUR_PROJECT_ID.iam.gserviceaccount.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--role<span class="o">=</span><span class="s2">&quot;roles/storage.admin&quot;</span>

<span class="c1"># Create and download service account key</span>
gcloud<span class="w"> </span>iam<span class="w"> </span>service-accounts<span class="w"> </span>keys<span class="w"> </span>create<span class="w"> </span>~/clustrix-service-account-key.json<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--iam-account<span class="o">=</span>clustrix-service-account@YOUR_PROJECT_ID.iam.gserviceaccount.com

<span class="c1"># Set the environment variable</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">GOOGLE_APPLICATION_CREDENTIALS</span><span class="o">=</span><span class="s2">&quot;/path/to/clustrix-service-account-key.json&quot;</span>
</pre></div>
</div>
<p><strong>Important</strong>: Make sure you have completed authentication setup and enabled all required APIs before proceeding.</p>
<p>If authentication fails, double-check that:</p>
<ul class="simple">
<li><p>Your project ID is correct</p></li>
<li><p>Billing is enabled for your project</p></li>
<li><p>Required APIs are enabled</p></li>
<li><p>Your credentials are properly configured</p></li>
</ul>
</section>
</section>
<section id="Method-1:-Google-Compute-Engine-Configuration">
<h2>Method 1: Google Compute Engine Configuration<a class="headerlink" href="#Method-1:-Google-Compute-Engine-Configuration" title="Link to this heading">¶</a></h2>
<section id="Create-Compute-Engine-Instance-for-Clustrix">
<h3>Create Compute Engine Instance for Clustrix<a class="headerlink" href="#Create-Compute-Engine-Instance-for-Clustrix" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_clustrix_compute_instance</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="s1">&#39;us-central1-a&#39;</span><span class="p">,</span> <span class="n">machine_type</span><span class="o">=</span><span class="s1">&#39;e2-standard-4&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a GCP Compute Engine instance configured for Clustrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id: GCP project ID</span>
<span class="sd">        zone: GCP zone for the instance</span>
<span class="sd">        machine_type: Machine type (CPU/memory configuration)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Instance configuration and gcloud commands</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Startup script for instance initialization</span>
    <span class="n">startup_script</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<span class="s1">#!/bin/bash</span>

<span class="s1"># Update system</span>
<span class="s1">apt-get update</span>
<span class="s1">apt-get install -y python3 python3-pip git htop curl</span>

<span class="s1"># Install clustrix and common packages</span>
<span class="s1">pip3 install clustrix numpy scipy pandas scikit-learn matplotlib</span>

<span class="s1"># Install uv for faster package management</span>
<span class="s1">curl -LsSf https://astral.sh/uv/install.sh | sh</span>
<span class="s1">source ~/.cargo/env</span>

<span class="s1"># Create clustrix user</span>
<span class="s1">useradd -m -s /bin/bash clustrix</span>
<span class="s1">usermod -aG sudo clustrix</span>
<span class="s1">echo &quot;clustrix ALL=(ALL) NOPASSWD:ALL&quot; &gt;&gt; /etc/sudoers</span>

<span class="s1"># Setup SSH for clustrix user</span>
<span class="s1">mkdir -p /home/clustrix/.ssh</span>
<span class="s1"># Copy SSH keys from default user</span>
<span class="s1">if [ -d &quot;/home/$(logname)/.ssh&quot; ]; then</span>
<span class="s1">    cp -r /home/$(logname)/.ssh/* /home/clustrix/.ssh/</span>
<span class="s1">    chown -R clustrix:clustrix /home/clustrix/.ssh</span>
<span class="s1">    chmod 700 /home/clustrix/.ssh</span>
<span class="s1">    chmod 600 /home/clustrix/.ssh/authorized_keys 2&gt;/dev/null || true</span>
<span class="s1">fi</span>

<span class="s1"># Create working directory</span>
<span class="s1">mkdir -p /tmp/clustrix</span>
<span class="s1">chown clustrix:clustrix /tmp/clustrix</span>

<span class="s1"># Install Google Cloud SDK for clustrix user</span>
<span class="s1">curl https://sdk.cloud.google.com | bash</span>
<span class="s1">exec -l $SHELL</span>

<span class="s1"># Log completion</span>
<span class="s1">echo &quot;Clustrix setup completed at $(date)&quot; &gt;&gt; /var/log/clustrix-setup.log</span>
<span class="s1">&#39;&#39;&#39;</span>

    <span class="c1"># gcloud commands for instance creation</span>
    <span class="n">gcloud_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Create firewall rule for SSH (if not exists)</span>
<span class="s2">gcloud compute firewall-rules create allow-ssh </span><span class="se">\</span>
<span class="s2">  --allow tcp:22 </span><span class="se">\</span>
<span class="s2">  --source-ranges 0.0.0.0/0 </span><span class="se">\</span>
<span class="s2">  --description &quot;Allow SSH access&quot; </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> || echo &quot;SSH rule already exists&quot;</span>

<span class="s2"># Create the instance</span>
<span class="s2">gcloud compute instances create clustrix-instance </span><span class="se">\</span>
<span class="s2">  --project=</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone=</span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --machine-type=</span><span class="si">{</span><span class="n">machine_type</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --network-interface=network-tier=PREMIUM,subnet=default </span><span class="se">\</span>
<span class="s2">  --maintenance-policy=MIGRATE </span><span class="se">\</span>
<span class="s2">  --provisioning-model=STANDARD </span><span class="se">\</span>
<span class="s2">  --service-account=default </span><span class="se">\</span>
<span class="s2">  --scopes=https://www.googleapis.com/auth/cloud-platform </span><span class="se">\</span>
<span class="s2">  --tags=clustrix,http-server,https-server </span><span class="se">\</span>
<span class="s2">  --create-disk=auto-delete=yes,boot=yes,device-name=clustrix-instance,image=projects/ubuntu-os-cloud/global/images/family/ubuntu-2204-lts,mode=rw,size=50,type=projects/</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">/zones/</span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2">/diskTypes/pd-balanced </span><span class="se">\</span>
<span class="s2">  --no-shielded-secure-boot </span><span class="se">\</span>
<span class="s2">  --shielded-vtpm </span><span class="se">\</span>
<span class="s2">  --shielded-integrity-monitoring </span><span class="se">\</span>
<span class="s2">  --labels=purpose=clustrix,environment=tutorial </span><span class="se">\</span>
<span class="s2">  --reservation-affinity=any </span><span class="se">\</span>
<span class="s2">  --metadata-from-file startup-script=startup-script.sh</span>

<span class="s2"># Get the external IP</span>
<span class="s2">gcloud compute instances describe clustrix-instance </span><span class="se">\</span>
<span class="s2">  --project=</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone=</span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --format=&#39;get(networkInterfaces[0].accessConfigs[0].natIP)&#39;</span>

<span class="s2"># SSH to the instance (after startup script completes)</span>
<span class="s2">gcloud compute ssh clustrix-instance </span><span class="se">\</span>
<span class="s2">  --project=</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone=</span><span class="si">{</span><span class="n">zone</span><span class="si">}</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;project_id&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
        <span class="s1">&#39;zone&#39;</span><span class="p">:</span> <span class="n">zone</span><span class="p">,</span>
        <span class="s1">&#39;machine_type&#39;</span><span class="p">:</span> <span class="n">machine_type</span><span class="p">,</span>
        <span class="s1">&#39;instance_name&#39;</span><span class="p">:</span> <span class="s1">&#39;clustrix-instance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gcloud_commands&#39;</span><span class="p">:</span> <span class="n">gcloud_commands</span><span class="p">,</span>
        <span class="s1">&#39;startup_script&#39;</span><span class="p">:</span> <span class="n">startup_script</span>
    <span class="p">}</span>

<span class="c1"># Example usage - replace with your actual project ID</span>
<span class="n">instance_config</span> <span class="o">=</span> <span class="n">create_clustrix_compute_instance</span><span class="p">(</span>
    <span class="n">project_id</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">,</span>  <span class="c1"># Using the PROJECT_ID variable from above</span>
    <span class="n">zone</span><span class="o">=</span><span class="s1">&#39;us-central1-a&#39;</span><span class="p">,</span>
    <span class="n">machine_type</span><span class="o">=</span><span class="s1">&#39;e2-standard-4&#39;</span>  <span class="c1"># 4 vCPUs, 16 GB RAM</span>
<span class="p">)</span>

<span class="c1"># Display the configuration results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== GCP Compute Engine Instance Configuration ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Project ID: </span><span class="si">{</span><span class="n">instance_config</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zone: </span><span class="si">{</span><span class="n">instance_config</span><span class="p">[</span><span class="s1">&#39;zone&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Machine Type: </span><span class="si">{</span><span class="n">instance_config</span><span class="p">[</span><span class="s1">&#39;machine_type&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Instance Name: </span><span class="si">{</span><span class="n">instance_config</span><span class="p">[</span><span class="s1">&#39;instance_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Next Steps ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;1. Save the startup script to &#39;startup-script.sh&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;2. Execute the gcloud commands shown above&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3. Wait 3-5 minutes for instance initialization&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4. Get the external IP and configure Clustrix&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="GCP-Compute-Engine-Instance-Creation">
<h3>GCP Compute Engine Instance Creation<a class="headerlink" href="#GCP-Compute-Engine-Instance-Creation" title="Link to this heading">¶</a></h3>
<p>The above code defines a function that creates a GCP Compute Engine instance optimized for Clustrix workloads. The function returns:</p>
<ul class="simple">
<li><p><strong>gcloud commands</strong>: Complete CLI commands to create the instance</p></li>
<li><p><strong>startup script</strong>: Automated setup script that configures the instance</p></li>
</ul>
<p>The configuration includes:</p>
<ul class="simple">
<li><p>Ubuntu 22.04 LTS base image</p></li>
<li><p>Pre-installed Python packages and Clustrix</p></li>
<li><p>Clustrix user account with sudo privileges</p></li>
<li><p>SSH key setup and working directories</p></li>
<li><p>50GB balanced persistent disk</p></li>
<li><p>Appropriate firewall rules and metadata</p></li>
</ul>
<p><strong>Next Steps</strong>:</p>
<ol class="arabic simple">
<li><p><strong>Save the startup script</strong> to a file named <code class="docutils literal notranslate"><span class="pre">startup-script.sh</span></code> in your current directory</p></li>
<li><p><strong>Execute the gcloud commands</strong> shown above to create your instance</p></li>
<li><p><strong>Wait for the instance to fully initialize</strong> (startup script takes 3-5 minutes)</p></li>
<li><p><strong>Get the external IP</strong> using the describe command shown above</p></li>
<li><p><strong>Test SSH access</strong> to ensure the instance is ready for Clustrix</p></li>
</ol>
</section>
<section id="Configure-Clustrix-for-Compute-Engine">
<h3>Configure Clustrix for Compute Engine<a class="headerlink" href="#Configure-Clustrix-for-Compute-Engine" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the external IP of your created instance</span>
<span class="c1"># Replace with the actual external IP from your instance</span>
<span class="n">INSTANCE_EXTERNAL_IP</span> <span class="o">=</span> <span class="s2">&quot;YOUR_INSTANCE_EXTERNAL_IP&quot;</span>  <span class="c1"># Replace this!</span>

<span class="c1"># Configure Clustrix to use your Compute Engine instance</span>
<span class="n">configure</span><span class="p">(</span>
    <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;ssh&quot;</span><span class="p">,</span>
    <span class="n">cluster_host</span><span class="o">=</span><span class="n">INSTANCE_EXTERNAL_IP</span><span class="p">,</span>
    <span class="n">username</span><span class="o">=</span><span class="s2">&quot;clustrix&quot;</span><span class="p">,</span>  <span class="c1"># or your default user</span>
    <span class="n">key_file</span><span class="o">=</span><span class="s2">&quot;~/.ssh/gcp_key&quot;</span><span class="p">,</span>  <span class="c1"># path to your SSH private key</span>
    <span class="n">remote_work_dir</span><span class="o">=</span><span class="s2">&quot;/tmp/clustrix&quot;</span><span class="p">,</span>
    <span class="n">package_manager</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span>  <span class="c1"># Will use uv if available, pip otherwise</span>
    <span class="n">default_cores</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">default_memory</span><span class="o">=</span><span class="s2">&quot;8GB&quot;</span><span class="p">,</span>
    <span class="n">default_time</span><span class="o">=</span><span class="s2">&quot;01:00:00&quot;</span>
<span class="p">)</span>

<span class="c1"># Verify configuration</span>
<span class="k">if</span> <span class="n">INSTANCE_EXTERNAL_IP</span> <span class="o">!=</span> <span class="s2">&quot;YOUR_INSTANCE_EXTERNAL_IP&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Clustrix configured for GCP Compute Engine&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Host: </span><span class="si">{</span><span class="n">INSTANCE_EXTERNAL_IP</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  SSH Key: ~/.ssh/gcp_key&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Remote Work Dir: /tmp/clustrix&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;⚠️  Please replace INSTANCE_EXTERNAL_IP with your actual IP address&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Important Configuration Notes</strong>:</p>
<ul class="simple">
<li><p>Replace <code class="docutils literal notranslate"><span class="pre">YOUR_INSTANCE_EXTERNAL_IP</span></code> with the actual external IP address from your Compute Engine instance</p></li>
<li><p>Use the SSH key path that corresponds to your setup (either <code class="docutils literal notranslate"><span class="pre">~/.ssh/gcp_key</span></code> if you created one following this tutorial, or <code class="docutils literal notranslate"><span class="pre">~/.ssh/google_compute_engine</span></code> for gcloud-generated keys)</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">clustrix</span></code> user was created by the startup script with appropriate permissions</p></li>
<li><p>If you encounter connection issues, ensure your firewall rules allow SSH access from your IP address</p></li>
</ul>
</section>
<section id="Example:-Remote-Computation-on-Compute-Engine">
<h3>Example: Remote Computation on Compute Engine<a class="headerlink" href="#Example:-Remote-Computation-on-Compute-Engine" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example: GCP Data Analysis</span>
<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;4GB&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gcp_data_analysis</span><span class="p">(</span><span class="n">dataset_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">analysis_type</span><span class="o">=</span><span class="s1">&#39;regression&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform data analysis on GCP Compute Engine.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
    <span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">RandomForestClassifier</span>
    <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span> <span class="n">accuracy_score</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span><span class="p">,</span> <span class="n">make_classification</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Generate synthetic dataset</span>
    <span class="k">if</span> <span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;regression&#39;</span><span class="p">:</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span>
            <span class="n">n_samples</span><span class="o">=</span><span class="n">dataset_size</span><span class="p">,</span>
            <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">noise</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
        <span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric_name</span> <span class="o">=</span> <span class="s1">&#39;rmse&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
            <span class="n">n_samples</span><span class="o">=</span><span class="n">dataset_size</span><span class="p">,</span>
            <span class="n">n_features</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
            <span class="n">n_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
        <span class="p">)</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">metric_name</span> <span class="o">=</span> <span class="s1">&#39;accuracy&#39;</span>

    <span class="c1"># Split data</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="c1"># Train model</span>
    <span class="n">training_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">training_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">training_start</span>

    <span class="c1"># Evaluate</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;regression&#39;</span><span class="p">:</span>
        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">metric_value</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="n">total_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;analysis_type&#39;</span><span class="p">:</span> <span class="n">analysis_type</span><span class="p">,</span>
        <span class="s1">&#39;dataset_size&#39;</span><span class="p">:</span> <span class="n">dataset_size</span><span class="p">,</span>
        <span class="s1">&#39;training_time&#39;</span><span class="p">:</span> <span class="n">training_time</span><span class="p">,</span>
        <span class="s1">&#39;total_time&#39;</span><span class="p">:</span> <span class="n">total_time</span><span class="p">,</span>
        <span class="n">metric_name</span><span class="p">:</span> <span class="n">metric_value</span><span class="p">,</span>
        <span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>  <span class="c1"># Top 5</span>
        <span class="s1">&#39;training_samples&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span>
        <span class="s1">&#39;test_samples&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># Example: Parallel Computation</span>
<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;8GB&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gcp_parallel_computation</span><span class="p">(</span><span class="n">n_iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Basic parallel computation example.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Simulate CPU-intensive work</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">):</span>
        <span class="c1"># Monte Carlo pi estimation</span>
        <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
        <span class="n">inside_circle</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">points</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">pi_estimate</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">inside_circle</span> <span class="o">/</span> <span class="mi">1000</span>
        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pi_estimate</span><span class="p">)</span>

    <span class="n">computation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>
    <span class="n">final_pi_estimate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;iterations&#39;</span><span class="p">:</span> <span class="n">n_iterations</span><span class="p">,</span>
        <span class="s1">&#39;pi_estimate&#39;</span><span class="p">:</span> <span class="n">final_pi_estimate</span><span class="p">,</span>
        <span class="s1">&#39;computation_time&#39;</span><span class="p">:</span> <span class="n">computation_time</span><span class="p">,</span>
        <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">final_pi_estimate</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ GCP computation examples defined&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📝 Example usage:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# Data analysis:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# result = gcp_data_analysis(dataset_size=50000, analysis_type=&#39;classification&#39;)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# print(f&#39;Accuracy: </span><span class="si">{result[\&quot;accuracy\&quot;]:.4f}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# Parallel computation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# result = gcp_parallel_computation(n_iterations=5000)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# print(f&#39;Pi estimate: </span><span class="si">{result[\&quot;pi_estimate\&quot;]:.6f}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>

<span class="c1"># Example execution (commented out - uncomment after setup):</span>
<span class="c1"># result = gcp_data_analysis(dataset_size=5000, analysis_type=&#39;classification&#39;)</span>
<span class="c1"># print(f&quot;✓ Analysis completed: {result[&#39;accuracy&#39;]:.4f} accuracy&quot;)</span>
<span class="c1"># print(f&quot;⏱️  Training time: {result[&#39;training_time&#39;]:.2f} seconds&quot;)</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="Method-2:-Google-Kubernetes-Engine-(GKE)-Configuration">
<h2>Method 2: Google Kubernetes Engine (GKE) Configuration<a class="headerlink" href="#Method-2:-Google-Kubernetes-Engine-(GKE)-Configuration" title="Link to this heading">¶</a></h2>
<p>GKE provides managed Kubernetes clusters ideal for containerized Clustrix workloads:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_gke_cluster_for_clustrix</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">cluster_name</span><span class="o">=</span><span class="s1">&#39;clustrix-cluster&#39;</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="s1">&#39;us-central1-a&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setup GKE cluster optimized for Clustrix workloads.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">gke_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Enable required APIs</span>
<span class="s2">gcloud services enable container.googleapis.com </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>

<span class="s2"># Create GKE cluster with auto-scaling</span>
<span class="s2">gcloud container clusters create </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --machine-type e2-standard-4 </span><span class="se">\</span>
<span class="s2">  --num-nodes 1 </span><span class="se">\</span>
<span class="s2">  --enable-autoscaling </span><span class="se">\</span>
<span class="s2">  --min-nodes 0 </span><span class="se">\</span>
<span class="s2">  --max-nodes 10 </span><span class="se">\</span>
<span class="s2">  --enable-autorepair </span><span class="se">\</span>
<span class="s2">  --enable-autoupgrade </span><span class="se">\</span>
<span class="s2">  --disk-size 50GB </span><span class="se">\</span>
<span class="s2">  --disk-type pd-ssd </span><span class="se">\</span>
<span class="s2">  --enable-network-policy </span><span class="se">\</span>
<span class="s2">  --enable-ip-alias </span><span class="se">\</span>
<span class="s2">  --labels purpose=clustrix,environment=tutorial</span>

<span class="s2"># Get cluster credentials</span>
<span class="s2">gcloud container clusters get-credentials </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span>

<span class="s2"># Verify cluster access</span>
<span class="s2">kubectl get nodes</span>

<span class="s2"># Create clustrix namespace</span>
<span class="s2">kubectl create namespace clustrix</span>

<span class="s2"># Set as default namespace</span>
<span class="s2">kubectl config set-context --current --namespace=clustrix</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="c1"># Clustrix job template for Kubernetes</span>
    <span class="n">k8s_job_template</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">apiVersion: batch/v1</span>
<span class="s2">kind: Job</span>
<span class="s2">metadata:</span>
<span class="s2">  name: clustrix-job-$</span><span class="si">{JOB_ID}</span>
<span class="s2">  namespace: clustrix</span>
<span class="s2">spec:</span>
<span class="s2">  template:</span>
<span class="s2">    spec:</span>
<span class="s2">      restartPolicy: Never</span>
<span class="s2">      containers:</span>
<span class="s2">      - name: clustrix-worker</span>
<span class="s2">        image: python:3.11-slim</span>
<span class="s2">        command: [&quot;bash&quot;, &quot;-c&quot;]</span>
<span class="s2">        args:</span>
<span class="s2">        - |</span>
<span class="s2">          pip install clustrix numpy scipy pandas scikit-learn</span>
<span class="s2">          python -c &quot;</span>
<span class="s2">          import pickle</span>
<span class="s2">          import sys</span>

<span class="s2">          # Load and execute function</span>
<span class="s2">          with open(&#39;/data/function_data.pkl&#39;, &#39;rb&#39;) as f:</span>
<span class="s2">              data = pickle.load(f)</span>

<span class="s2">          func = pickle.loads(data[&#39;function&#39;])</span>
<span class="s2">          args = pickle.loads(data[&#39;args&#39;])</span>
<span class="s2">          kwargs = pickle.loads(data[&#39;kwargs&#39;])</span>

<span class="s2">          try:</span>
<span class="s2">              result = func(*args, **kwargs)</span>
<span class="s2">              with open(&#39;/data/result.pkl&#39;, &#39;wb&#39;) as f:</span>
<span class="s2">                  pickle.dump(result, f)</span>
<span class="s2">          except Exception as e:</span>
<span class="s2">              with open(&#39;/data/error.pkl&#39;, &#39;wb&#39;) as f:</span>
<span class="s2">                  pickle.dump({&#39;error&#39;: str(e)}, f)</span>
<span class="s2">              raise</span>
<span class="s2">          &quot;</span>
<span class="s2">        resources:</span>
<span class="s2">          requests:</span>
<span class="s2">            memory: &quot;2Gi&quot;</span>
<span class="s2">            cpu: &quot;1&quot;</span>
<span class="s2">          limits:</span>
<span class="s2">            memory: &quot;4Gi&quot;</span>
<span class="s2">            cpu: &quot;2&quot;</span>
<span class="s2">        volumeMounts:</span>
<span class="s2">        - name: job-data</span>
<span class="s2">          mountPath: /data</span>
<span class="s2">      volumes:</span>
<span class="s2">      - name: job-data</span>
<span class="s2">        persistentVolumeClaim:</span>
<span class="s2">          claimName: clustrix-pvc</span>
<span class="s2">  backoffLimit: 3</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;cluster_name&#39;</span><span class="p">:</span> <span class="n">cluster_name</span><span class="p">,</span>
        <span class="s1">&#39;project_id&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
        <span class="s1">&#39;zone&#39;</span><span class="p">:</span> <span class="n">zone</span><span class="p">,</span>
        <span class="s1">&#39;setup_commands&#39;</span><span class="p">:</span> <span class="n">gke_commands</span><span class="p">,</span>
        <span class="s1">&#39;job_template&#39;</span><span class="p">:</span> <span class="n">k8s_job_template</span>
    <span class="p">}</span>

<span class="k">def</span> <span class="nf">configure_clustrix_for_gke</span><span class="p">(</span><span class="n">cluster_endpoint</span><span class="p">,</span> <span class="n">cluster_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Configure Clustrix to use GKE cluster.&quot;&quot;&quot;</span>
    <span class="n">configure</span><span class="p">(</span>
        <span class="n">cluster_type</span><span class="o">=</span><span class="s2">&quot;kubernetes&quot;</span><span class="p">,</span>
        <span class="n">cluster_host</span><span class="o">=</span><span class="n">cluster_endpoint</span><span class="p">,</span>
        <span class="c1"># For GKE, authentication is handled via kubectl config</span>
        <span class="n">remote_work_dir</span><span class="o">=</span><span class="s2">&quot;/tmp/clustrix&quot;</span><span class="p">,</span>
        <span class="n">package_manager</span><span class="o">=</span><span class="s2">&quot;pip&quot;</span><span class="p">,</span>  <span class="c1"># Container-based, pip is fine</span>
        <span class="n">default_cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">default_memory</span><span class="o">=</span><span class="s2">&quot;4GB&quot;</span><span class="p">,</span>
        <span class="n">default_time</span><span class="o">=</span><span class="s2">&quot;01:00:00&quot;</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Configured Clustrix for GKE cluster: </span><span class="si">{</span><span class="n">cluster_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Create GKE configuration</span>
<span class="n">gke_config</span> <span class="o">=</span> <span class="n">setup_gke_cluster_for_clustrix</span><span class="p">(</span>
    <span class="n">project_id</span><span class="o">=</span><span class="n">PROJECT_ID</span><span class="p">,</span>
    <span class="n">cluster_name</span><span class="o">=</span><span class="s1">&#39;clustrix-cluster&#39;</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== GKE Cluster Setup Commands ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gke_config</span><span class="p">[</span><span class="s1">&#39;setup_commands&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Kubernetes Job Template ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gke_config</span><span class="p">[</span><span class="s1">&#39;job_template&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📝 Note: GKE integration requires additional implementation in Clustrix.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Current Clustrix supports basic Kubernetes, but GKE-specific features need custom setup.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Method-3:-Google-Cloud-Batch">
<h2>Method 3: Google Cloud Batch<a class="headerlink" href="#Method-3:-Google-Cloud-Batch" title="Link to this heading">¶</a></h2>
<p>Google Cloud Batch provides managed job scheduling for large-scale workloads:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_gcp_batch_environment</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;us-central1&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setup Google Cloud Batch for Clustrix workloads.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">batch_setup_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Enable Batch API</span>
<span class="s2">gcloud services enable batch.googleapis.com </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>

<span class="s2"># Create a service account for Batch jobs</span>
<span class="s2">gcloud iam service-accounts create clustrix-batch-sa </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --description=&quot;Service account for Clustrix Batch jobs&quot; </span><span class="se">\</span>
<span class="s2">  --display-name=&quot;Clustrix Batch Service Account&quot;</span>

<span class="s2"># Grant necessary permissions</span>
<span class="s2">gcloud projects add-iam-policy-binding </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --member=&quot;serviceAccount:clustrix-batch-sa@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com&quot; </span><span class="se">\</span>
<span class="s2">  --role=&quot;roles/batch.jobsEditor&quot;</span>

<span class="s2">gcloud projects add-iam-policy-binding </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --member=&quot;serviceAccount:clustrix-batch-sa@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com&quot; </span><span class="se">\</span>
<span class="s2">  --role=&quot;roles/storage.objectAdmin&quot;</span>

<span class="s2"># Create Cloud Storage bucket for job data</span>
<span class="s2">gsutil mb -p </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> -l </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-clustrix-batch</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="c1"># Batch job configuration template</span>
    <span class="n">batch_job_config</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;taskGroups&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;taskSpec&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;runnables&quot;</span><span class="p">:</span> <span class="p">[</span>
                        <span class="p">{</span>
                            <span class="s2">&quot;script&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">#!/bin/bash</span>
<span class="s2">set -e</span>

<span class="s2"># Install required packages</span>
<span class="s2">pip3 install clustrix numpy scipy pandas scikit-learn</span>

<span class="s2"># Download job data from Cloud Storage</span>
<span class="s2">gsutil cp gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-clustrix-batch/jobs/$</span><span class="se">{{</span><span class="s2">BATCH_JOB_ID</span><span class="se">}}</span><span class="s2">/function_data.pkl .</span>

<span class="s2"># Execute the function</span>
<span class="s2">python3 -c &quot;</span>
<span class="s2">import pickle</span>
<span class="s2">import traceback</span>

<span class="s2">try:</span>
<span class="s2">    with open(&#39;function_data.pkl&#39;, &#39;rb&#39;) as f:</span>
<span class="s2">        data = pickle.load(f)</span>

<span class="s2">    func = pickle.loads(data[&#39;function&#39;])</span>
<span class="s2">    args = pickle.loads(data[&#39;args&#39;])</span>
<span class="s2">    kwargs = pickle.loads(data[&#39;kwargs&#39;])</span>

<span class="s2">    result = func(*args, **kwargs)</span>

<span class="s2">    with open(&#39;result.pkl&#39;, &#39;wb&#39;) as f:</span>
<span class="s2">        pickle.dump(result, f)</span>

<span class="s2">except Exception as e:</span>
<span class="s2">    with open(&#39;error.pkl&#39;, &#39;wb&#39;) as f:</span>
<span class="s2">        pickle.dump(</span><span class="se">{{</span>
<span class="s2">            &#39;error&#39;: str(e),</span>
<span class="s2">            &#39;traceback&#39;: traceback.format_exc()</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">, f)</span>
<span class="s2">    raise</span>
<span class="s2">&quot;</span>

<span class="s2"># Upload results to Cloud Storage</span>
<span class="s2">gsutil cp result.pkl gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-clustrix-batch/jobs/$</span><span class="se">{{</span><span class="s2">BATCH_JOB_ID</span><span class="se">}}</span><span class="s2">/result.pkl || </span><span class="se">\</span>
<span class="s2">gsutil cp error.pkl gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-clustrix-batch/jobs/$</span><span class="se">{{</span><span class="s2">BATCH_JOB_ID</span><span class="se">}}</span><span class="s2">/error.pkl</span>
<span class="s2">&quot;&quot;&quot;</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">],</span>
                    <span class="s2">&quot;computeResource&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;cpuMilli&quot;</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>  <span class="c1"># 2 CPUs</span>
                        <span class="s2">&quot;memoryMib&quot;</span><span class="p">:</span> <span class="mi">4096</span>  <span class="c1"># 4 GB RAM</span>
                    <span class="p">},</span>
                    <span class="s2">&quot;maxRetryCount&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
                    <span class="s2">&quot;maxRunDuration&quot;</span><span class="p">:</span> <span class="s2">&quot;3600s&quot;</span>  <span class="c1"># 1 hour</span>
                <span class="p">},</span>
                <span class="s2">&quot;taskCount&quot;</span><span class="p">:</span> <span class="mi">1</span>
            <span class="p">}</span>
        <span class="p">],</span>
        <span class="s2">&quot;allocationPolicy&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;instances&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;instanceTemplate&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;machineType&quot;</span><span class="p">:</span> <span class="s2">&quot;e2-standard-2&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;provisioningModel&quot;</span><span class="p">:</span> <span class="s2">&quot;STANDARD&quot;</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">]</span>
        <span class="p">},</span>
        <span class="s2">&quot;labels&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;purpose&quot;</span><span class="p">:</span> <span class="s2">&quot;clustrix&quot;</span><span class="p">,</span>
            <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="s2">&quot;tutorial&quot;</span>
        <span class="p">},</span>
        <span class="s2">&quot;logsPolicy&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;CLOUD_LOGGING&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;project_id&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s1">&#39;bucket_name&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">-clustrix-batch&#39;</span><span class="p">,</span>
        <span class="s1">&#39;service_account&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;clustrix-batch-sa@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">.iam.gserviceaccount.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;job_config&#39;</span><span class="p">:</span> <span class="n">batch_job_config</span><span class="p">,</span>
        <span class="s1">&#39;setup_commands&#39;</span><span class="p">:</span> <span class="n">batch_setup_commands</span>
    <span class="p">}</span>

<span class="c1"># Create Batch configuration</span>
<span class="n">batch_config</span> <span class="o">=</span> <span class="n">setup_gcp_batch_environment</span><span class="p">(</span><span class="n">PROJECT_ID</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Google Cloud Batch Setup Commands ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">batch_config</span><span class="p">[</span><span class="s1">&#39;setup_commands&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Batch Job Configuration ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">batch_config</span><span class="p">[</span><span class="s1">&#39;job_config&#39;</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">💡 Google Cloud Batch provides excellent integration for large-scale Clustrix workloads.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Data-Management-with-Google-Cloud-Storage">
<h2>Data Management with Google Cloud Storage<a class="headerlink" href="#Data-Management-with-Google-Cloud-Storage" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;4GB&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_gcs_data</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">input_blob</span><span class="p">,</span> <span class="n">output_blob</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process data from Google Cloud Storage and save results back.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">storage</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">pickle</span>
    <span class="kn">import</span> <span class="nn">io</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="c1"># Initialize Cloud Storage client</span>
    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">)</span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>

    <span class="c1"># Download data from Cloud Storage</span>
    <span class="n">input_blob_obj</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">input_blob</span><span class="p">)</span>
    <span class="n">data_bytes</span> <span class="o">=</span> <span class="n">input_blob_obj</span><span class="o">.</span><span class="n">download_as_bytes</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data_bytes</span><span class="p">)</span>

    <span class="c1"># Process the data</span>
    <span class="n">processed_data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;original_shape&#39;</span><span class="p">:</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__len__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;scalar&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mean&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
        <span class="s1">&#39;std&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
        <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;__iter__&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">),</span>
        <span class="s1">&#39;processing_timestamp&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">(),</span>
        <span class="s1">&#39;processed_on&#39;</span><span class="p">:</span> <span class="s1">&#39;gcp-compute-engine&#39;</span><span class="p">,</span>
        <span class="s1">&#39;data_type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Advanced processing based on data type</span>
    <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Matrix operations</span>
        <span class="n">processed_data</span><span class="o">.</span><span class="n">update</span><span class="p">({</span>
            <span class="s1">&#39;matrix_rank&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;non_square&#39;</span><span class="p">,</span>
            <span class="s1">&#39;frobenius_norm&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;fro&#39;</span><span class="p">)),</span>
            <span class="s1">&#39;condition_number&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cond</span><span class="p">(</span><span class="n">data</span><span class="p">))</span> <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
        <span class="p">})</span>

    <span class="c1"># Upload results to Cloud Storage</span>
    <span class="n">output_bytes</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">processed_data</span><span class="p">)</span>
    <span class="n">output_blob_obj</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">output_blob</span><span class="p">)</span>
    <span class="n">output_blob_obj</span><span class="o">.</span><span class="n">upload_from_string</span><span class="p">(</span><span class="n">output_bytes</span><span class="p">)</span>

    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Processed data saved to gs://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">output_blob</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="c1"># Utility functions for Google Cloud Storage</span>
<span class="k">def</span> <span class="nf">upload_to_gcs</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">blob_name</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Upload data to Google Cloud Storage.&quot;&quot;&quot;</span>
    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">)</span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">blob_name</span><span class="p">)</span>

    <span class="n">data_bytes</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="n">blob</span><span class="o">.</span><span class="n">upload_from_string</span><span class="p">(</span><span class="n">data_bytes</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;gs://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">blob_name</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="k">def</span> <span class="nf">download_from_gcs</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">,</span> <span class="n">blob_name</span><span class="p">,</span> <span class="n">project_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Download data from Google Cloud Storage.&quot;&quot;&quot;</span>
    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">)</span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>
    <span class="n">blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="n">blob_name</span><span class="p">)</span>

    <span class="n">data_bytes</span> <span class="o">=</span> <span class="n">blob</span><span class="o">.</span><span class="n">download_as_bytes</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">pickle</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data_bytes</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">create_gcs_bucket_for_clustrix</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;us-central1&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Cloud Storage bucket for Clustrix data.&quot;&quot;&quot;</span>
    <span class="n">gcs_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Create bucket with appropriate settings</span>
<span class="s2">gsutil mb -p </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> -l </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2"> gs://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span>

<span class="s2"># Set lifecycle policy to delete temporary files after 7 days</span>
<span class="s2">echo &#39;</span><span class="se">{{</span>
<span class="s2">  &quot;lifecycle&quot;: </span><span class="se">{{</span>
<span class="s2">    &quot;rule&quot;: [</span>
<span class="s2">      </span><span class="se">{{</span>
<span class="s2">        &quot;action&quot;: </span><span class="se">{{</span><span class="s2">&quot;type&quot;: &quot;Delete&quot;</span><span class="se">}}</span><span class="s2">,</span>
<span class="s2">        &quot;condition&quot;: </span><span class="se">{{</span>
<span class="s2">          &quot;age&quot;: 7,</span>
<span class="s2">          &quot;matchesPrefix&quot;: [&quot;temp/&quot;]</span>
<span class="s2">        </span><span class="se">}}</span>
<span class="s2">      </span><span class="se">}}</span>
<span class="s2">    ]</span>
<span class="s2">  </span><span class="se">}}</span>
<span class="se">}}</span><span class="s2">&#39; &gt; lifecycle.json</span>

<span class="s2">gsutil lifecycle set lifecycle.json gs://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span>

<span class="s2"># Set up proper permissions (if using service account)</span>
<span class="s2">gsutil iam ch serviceAccount:clustrix-batch-sa@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com:objectAdmin gs://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">gcs_commands</span>

<span class="c1"># Create bucket configuration</span>
<span class="n">BUCKET_NAME</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">PROJECT_ID</span><span class="si">}</span><span class="s2">-clustrix-data&quot;</span>
<span class="n">bucket_commands</span> <span class="o">=</span> <span class="n">create_gcs_bucket_for_clustrix</span><span class="p">(</span><span class="n">PROJECT_ID</span><span class="p">,</span> <span class="n">BUCKET_NAME</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Commands to create Cloud Storage bucket ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bucket_commands</span><span class="p">)</span>

<span class="c1"># Example usage (commented out - uncomment after creating bucket):</span>
<span class="c1"># sample_data = np.random.rand(1000, 100)</span>
<span class="c1"># upload_location = upload_to_gcs(sample_data, BUCKET_NAME, &#39;input/sample_data.pkl&#39;, PROJECT_ID)</span>
<span class="c1"># print(f&quot;✓ Data uploaded to {upload_location}&quot;)</span>
<span class="c1">#</span>
<span class="c1"># result = process_gcs_data(BUCKET_NAME, &#39;input/sample_data.pkl&#39;, &#39;output/results.pkl&#39;, PROJECT_ID)</span>
<span class="c1"># print(f&quot;✓ Processing completed: {result}&quot;)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Google Cloud Storage integration functions defined.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Execute the bucket creation commands above, then uncomment the example usage.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Vertex-AI-Integration">
<h2>Vertex AI Integration<a class="headerlink" href="#Vertex-AI-Integration" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_vertex_ai_for_clustrix</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;us-central1&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Setup Vertex AI for ML workloads with Clustrix.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">vertex_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Enable Vertex AI API</span>
<span class="s2">gcloud services enable aiplatform.googleapis.com </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>

<span class="s2"># Create Vertex AI custom training job</span>
<span class="s2">gcloud ai custom-jobs create </span><span class="se">\</span>
<span class="s2">  --region=</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --display-name=clustrix-training-job </span><span class="se">\</span>
<span class="s2">  --config=training_job_config.yaml</span>

<span class="s2"># Create Vertex AI endpoints for model serving</span>
<span class="s2">gcloud ai endpoints create </span><span class="se">\</span>
<span class="s2">  --region=</span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --display-name=clustrix-model-endpoint</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="c1"># Vertex AI training job configuration</span>
    <span class="n">training_config</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># training_job_config.yaml</span>
<span class="s2">workerPoolSpecs:</span>
<span class="s2">- machineSpec:</span>
<span class="s2">    machineType: e2-standard-4</span>
<span class="s2">  replicaCount: 1</span>
<span class="s2">  containerSpec:</span>
<span class="s2">    imageUri: gcr.io/cloud-aiplatform/training/tf-cpu.2-8:latest</span>
<span class="s2">    command:</span>
<span class="s2">    - python3</span>
<span class="s2">    - -c</span>
<span class="s2">    args:</span>
<span class="s2">    - |</span>
<span class="s2">      import subprocess</span>
<span class="s2">      import sys</span>

<span class="s2">      # Install clustrix</span>
<span class="s2">      subprocess.check_call([sys.executable, &#39;-m&#39;, &#39;pip&#39;, &#39;install&#39;, &#39;clustrix&#39;, &#39;numpy&#39;, &#39;pandas&#39;, &#39;scikit-learn&#39;])</span>

<span class="s2">      # Your training code here</span>
<span class="s2">      print(&quot;Clustrix training job completed on Vertex AI&quot;)</span>
<span class="s2">    env:</span>
<span class="s2">    - name: GOOGLE_CLOUD_PROJECT</span>
<span class="s2">      value: </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>
<span class="s2">    - name: AIP_MODEL_DIR</span>
<span class="s2">      value: gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-vertex-models</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;project_id&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s1">&#39;setup_commands&#39;</span><span class="p">:</span> <span class="n">vertex_commands</span><span class="p">,</span>
        <span class="s1">&#39;training_config&#39;</span><span class="p">:</span> <span class="n">training_config</span>
    <span class="p">}</span>

<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;8GB&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">vertex_ai_ml_pipeline</span><span class="p">(</span><span class="n">dataset_config</span><span class="p">,</span> <span class="n">model_config</span><span class="p">,</span> <span class="n">project_id</span><span class="p">,</span> <span class="n">bucket_name</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ML pipeline that could run on Vertex AI with Clustrix.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingClassifier</span>
    <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">GridSearchCV</span>
    <span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
    <span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>
    <span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">storage</span>
    <span class="kn">import</span> <span class="nn">pickle</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Generate or load dataset</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span>
        <span class="n">n_samples</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">[</span><span class="s1">&#39;n_samples&#39;</span><span class="p">],</span>
        <span class="n">n_features</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">[</span><span class="s1">&#39;n_features&#39;</span><span class="p">],</span>
        <span class="n">n_classes</span><span class="o">=</span><span class="n">dataset_config</span><span class="p">[</span><span class="s1">&#39;n_classes&#39;</span><span class="p">],</span>
        <span class="n">n_informative</span><span class="o">=</span><span class="n">dataset_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;n_informative&#39;</span><span class="p">,</span> <span class="n">dataset_config</span><span class="p">[</span><span class="s1">&#39;n_features&#39;</span><span class="p">]</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span>
        <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
    <span class="p">)</span>

    <span class="c1"># Hyperparameter tuning</span>
    <span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;n_estimators&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span>
        <span class="s1">&#39;max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
        <span class="s1">&#39;learning_rate&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
    <span class="p">}</span>

    <span class="c1"># Grid search with cross-validation</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">GradientBoostingClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span>
        <span class="n">model</span><span class="p">,</span> <span class="n">param_grid</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
    <span class="p">)</span>

    <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># Get best model</span>
    <span class="n">best_model</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_estimator_</span>

    <span class="c1"># Evaluate with cross-validation</span>
    <span class="n">cv_scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">best_model</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="s1">&#39;accuracy&#39;</span><span class="p">)</span>

    <span class="c1"># Save model to Cloud Storage</span>
    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">project_id</span><span class="p">)</span>
    <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="n">bucket_name</span><span class="p">)</span>

    <span class="n">model_blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="s1">&#39;models/clustrix_model.pkl&#39;</span><span class="p">)</span>
    <span class="n">model_bytes</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">best_model</span><span class="p">)</span>
    <span class="n">model_blob</span><span class="o">.</span><span class="n">upload_from_string</span><span class="p">(</span><span class="n">model_bytes</span><span class="p">)</span>

    <span class="n">total_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;best_params&#39;</span><span class="p">:</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_params_</span><span class="p">,</span>
        <span class="s1">&#39;best_score&#39;</span><span class="p">:</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">best_score_</span><span class="p">,</span>
        <span class="s1">&#39;cv_mean_score&#39;</span><span class="p">:</span> <span class="n">cv_scores</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
        <span class="s1">&#39;cv_std_score&#39;</span><span class="p">:</span> <span class="n">cv_scores</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span>
        <span class="s1">&#39;training_time&#39;</span><span class="p">:</span> <span class="n">total_time</span><span class="p">,</span>
        <span class="s1">&#39;model_location&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;gs://</span><span class="si">{</span><span class="n">bucket_name</span><span class="si">}</span><span class="s1">/models/clustrix_model.pkl&#39;</span><span class="p">,</span>
        <span class="s1">&#39;feature_importance&#39;</span><span class="p">:</span> <span class="n">best_model</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>  <span class="c1"># Top 10</span>
        <span class="s1">&#39;dataset_size&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="p">}</span>

<span class="c1"># Setup Vertex AI configuration</span>
<span class="n">vertex_config</span> <span class="o">=</span> <span class="n">setup_vertex_ai_for_clustrix</span><span class="p">(</span><span class="n">PROJECT_ID</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== Vertex AI Setup Commands ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vertex_config</span><span class="p">[</span><span class="s1">&#39;setup_commands&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">=== Training Job Configuration ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vertex_config</span><span class="p">[</span><span class="s1">&#39;training_config&#39;</span><span class="p">])</span>

<span class="c1"># Example usage (commented out):</span>
<span class="c1"># dataset_params = {&#39;n_samples&#39;: 10000, &#39;n_features&#39;: 20, &#39;n_classes&#39;: 3}</span>
<span class="c1"># model_params = {}</span>
<span class="c1"># result = vertex_ai_ml_pipeline(dataset_params, model_params, PROJECT_ID, BUCKET_NAME)</span>
<span class="c1"># print(f&quot;✓ Best model score: {result[&#39;best_score&#39;]:.4f}&quot;)</span>
<span class="c1"># print(f&quot;✓ Model saved to: {result[&#39;model_location&#39;]}&quot;)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Vertex AI integration examples defined.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Security-Best-Practices">
<h2>Security Best Practices<a class="headerlink" href="#Security-Best-Practices" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">setup_gcp_security_for_clustrix</span><span class="p">(</span><span class="n">project_id</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Security configuration for GCP + Clustrix deployment.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">security_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># Create VPC with private subnets</span>
<span class="s2">gcloud compute networks create clustrix-vpc </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --subnet-mode custom</span>

<span class="s2">gcloud compute networks subnets create clustrix-subnet </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --network clustrix-vpc </span><span class="se">\</span>
<span class="s2">  --range 10.1.0.0/24 </span><span class="se">\</span>
<span class="s2">  --region us-central1 </span><span class="se">\</span>
<span class="s2">  --enable-private-ip-google-access</span>

<span class="s2"># Create firewall rules (restrictive)</span>
<span class="s2">gcloud compute firewall-rules create clustrix-allow-ssh </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --network clustrix-vpc </span><span class="se">\</span>
<span class="s2">  --allow tcp:22 </span><span class="se">\</span>
<span class="s2">  --source-ranges YOUR_IP/32 </span><span class="se">\</span>
<span class="s2">  --target-tags clustrix</span>

<span class="s2">gcloud compute firewall-rules create clustrix-internal </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --network clustrix-vpc </span><span class="se">\</span>
<span class="s2">  --allow tcp,udp,icmp </span><span class="se">\</span>
<span class="s2">  --source-ranges 10.1.0.0/24 </span><span class="se">\</span>
<span class="s2">  --target-tags clustrix</span>

<span class="s2"># Create service account with minimal permissions</span>
<span class="s2">gcloud iam service-accounts create clustrix-compute </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --description=&quot;Service account for Clustrix compute instances&quot; </span><span class="se">\</span>
<span class="s2">  --display-name=&quot;Clustrix Compute Service Account&quot;</span>

<span class="s2"># Grant only necessary permissions</span>
<span class="s2">gcloud projects add-iam-policy-binding </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --member=&quot;serviceAccount:clustrix-compute@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com&quot; </span><span class="se">\</span>
<span class="s2">  --role=&quot;roles/storage.objectAdmin&quot;</span>

<span class="s2">gcloud projects add-iam-policy-binding </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --member=&quot;serviceAccount:clustrix-compute@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com&quot; </span><span class="se">\</span>
<span class="s2">  --role=&quot;roles/logging.logWriter&quot;</span>

<span class="s2"># Enable OS Login for better SSH key management</span>
<span class="s2">gcloud compute project-info add-metadata </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --metadata enable-oslogin=TRUE</span>

<span class="s2"># Create Cloud KMS key for encryption</span>
<span class="s2">gcloud kms keyrings create clustrix-keyring </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --location global</span>

<span class="s2">gcloud kms keys create clustrix-key </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --keyring clustrix-keyring </span><span class="se">\</span>
<span class="s2">  --location global </span><span class="se">\</span>
<span class="s2">  --purpose encryption</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;project_id&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
        <span class="s1">&#39;vpc_name&#39;</span><span class="p">:</span> <span class="s1">&#39;clustrix-vpc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;subnet_name&#39;</span><span class="p">:</span> <span class="s1">&#39;clustrix-subnet&#39;</span><span class="p">,</span>
        <span class="s1">&#39;service_account&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;clustrix-compute@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s1">.iam.gserviceaccount.com&#39;</span><span class="p">,</span>
        <span class="s1">&#39;security_commands&#39;</span><span class="p">:</span> <span class="n">security_commands</span>
    <span class="p">}</span>

<span class="c1"># Generate security configuration</span>
<span class="n">security_config</span> <span class="o">=</span> <span class="n">setup_gcp_security_for_clustrix</span><span class="p">(</span><span class="n">PROJECT_ID</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=== GCP Security Setup Commands ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">security_config</span><span class="p">[</span><span class="s1">&#39;security_commands&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Security configuration templates generated for project: </span><span class="si">{</span><span class="n">PROJECT_ID</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ VPC: </span><span class="si">{</span><span class="n">security_config</span><span class="p">[</span><span class="s1">&#39;vpc_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Service Account: </span><span class="si">{</span><span class="n">security_config</span><span class="p">[</span><span class="s1">&#39;service_account&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">⚠️  Remember to replace &#39;YOUR_IP&#39; with your actual IP address in the firewall rules!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="GCP-Security-Checklist-for-Clustrix">
<h3>GCP Security Checklist for Clustrix<a class="headerlink" href="#GCP-Security-Checklist-for-Clustrix" title="Link to this heading">¶</a></h3>
<p>✓ <strong>Authentication and Access</strong></p>
<ul class="simple">
<li><p>Use IAM service accounts with minimal permissions</p></li>
<li><p>Enable OS Login for centralized SSH key management</p></li>
<li><p>Create custom VPC with private subnets</p></li>
<li><p>Restrict firewall rules to specific IP ranges</p></li>
</ul>
<p>✓ <strong>Infrastructure Security</strong></p>
<ul class="simple">
<li><p>Enable private Google access for instances without external IPs</p></li>
<li><p>Use Cloud KMS for encryption at rest</p></li>
<li><p>Enable audit logging and Cloud Security Command Center</p></li>
<li><p>Use Binary Authorization for container security</p></li>
</ul>
<p>✓ <strong>Network Security</strong></p>
<ul class="simple">
<li><p>Implement VPC Service Controls for data perimeter</p></li>
<li><p>Enable DDoS protection and Cloud Armor</p></li>
<li><p>Use Secret Manager for sensitive configuration</p></li>
<li><p>Enable vulnerability scanning for container images</p></li>
</ul>
<p>✓ <strong>Governance and Compliance</strong></p>
<ul class="simple">
<li><p>Set up budget alerts and billing account security</p></li>
<li><p>Use organization policies for governance</p></li>
<li><p>Regular security reviews and access audits</p></li>
</ul>
</section>
</section>
<section id="Resource-Cleanup">
<h2>Resource Cleanup<a class="headerlink" href="#Resource-Cleanup" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cleanup_gcp_resources</span><span class="p">(</span><span class="n">project_id</span><span class="p">,</span> <span class="n">zone</span><span class="o">=</span><span class="s1">&#39;us-central1-a&#39;</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="s1">&#39;us-central1&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clean up GCP resources to avoid ongoing charges.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_id: GCP project ID</span>
<span class="sd">        zone: Zone where resources were created</span>
<span class="sd">        region: Region where resources were created</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">cleanup_commands</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2"># List all compute instances</span>
<span class="s2">gcloud compute instances list --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>

<span class="s2"># Delete specific instances</span>
<span class="s2">gcloud compute instances delete clustrix-instance </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># Delete managed instance groups</span>
<span class="s2">gcloud compute instance-groups managed delete clustrix-preemptible-group </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># Delete instance templates</span>
<span class="s2">gcloud compute instance-templates delete clustrix-preemptible-template </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># Delete GKE clusters</span>
<span class="s2">gcloud container clusters delete clustrix-cluster </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --zone </span><span class="si">{</span><span class="n">zone</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># Delete Cloud Storage buckets (BE CAREFUL - THIS DELETES ALL DATA)</span>
<span class="s2">gsutil -m rm -r gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-clustrix-batch</span>
<span class="s2">gsutil -m rm -r gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-vertex-models</span>
<span class="s2">gsutil -m rm -r gs://</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">-clustrix-data</span>

<span class="s2"># Delete firewall rules</span>
<span class="s2">gcloud compute firewall-rules delete clustrix-allow-ssh clustrix-internal </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># Delete VPC network</span>
<span class="s2">gcloud compute networks subnets delete clustrix-subnet </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --region </span><span class="si">{</span><span class="n">region</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2">gcloud compute networks delete clustrix-vpc </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># Delete service accounts</span>
<span class="s2">gcloud iam service-accounts delete clustrix-compute@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2">gcloud iam service-accounts delete clustrix-batch-sa@</span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2">.iam.gserviceaccount.com </span><span class="se">\</span>
<span class="s2">  --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span><span class="s2"> </span><span class="se">\</span>
<span class="s2">  --quiet</span>

<span class="s2"># List remaining billable resources</span>
<span class="s2">echo &quot;=== Remaining billable resources ===&quot;</span>
<span class="s2">gcloud compute instances list --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>
<span class="s2">gcloud compute disks list --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>
<span class="s2">gcloud compute addresses list --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>
<span class="s2">gcloud container clusters list --project </span><span class="si">{</span><span class="n">project_id</span><span class="si">}</span>
<span class="s2">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;project_id&#39;</span><span class="p">:</span> <span class="n">project_id</span><span class="p">,</span>
        <span class="s1">&#39;zone&#39;</span><span class="p">:</span> <span class="n">zone</span><span class="p">,</span>
        <span class="s1">&#39;region&#39;</span><span class="p">:</span> <span class="n">region</span><span class="p">,</span>
        <span class="s1">&#39;cleanup_commands&#39;</span><span class="p">:</span> <span class="n">cleanup_commands</span>
    <span class="p">}</span>

<span class="c1"># Generate cleanup commands</span>
<span class="n">cleanup_info</span> <span class="o">=</span> <span class="n">cleanup_gcp_resources</span><span class="p">(</span><span class="n">PROJECT_ID</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;=== GCP Resource Cleanup Commands for Project: </span><span class="si">{</span><span class="n">PROJECT_ID</span><span class="si">}</span><span class="s2"> ===&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cleanup_info</span><span class="p">[</span><span class="s1">&#39;cleanup_commands&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">⚠️  WARNING: Some commands will permanently delete resources and data!&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Review each resource before deleting and ensure you have backups if needed.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">💡 TIP: Use &#39;gcloud compute instances stop&#39; instead of &#39;delete&#39; to preserve instances while stopping charges.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">✓ Cleanup commands generated. Always verify resources before deletion!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Advanced-Example:-Distributed-Scientific-Computing">
<h2>Advanced Example: Distributed Scientific Computing<a class="headerlink" href="#Advanced-Example:-Distributed-Scientific-Computing" title="Link to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Advanced Scientific Computing</span>
<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;8GB&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s2">&quot;01:00:00&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gcp_scientific_simulation</span><span class="p">(</span><span class="n">simulation_params</span><span class="p">,</span> <span class="n">storage_config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Distributed scientific simulation using GCP infrastructure.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
    <span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>
    <span class="kn">import</span> <span class="nn">pickle</span>
    <span class="kn">import</span> <span class="nn">time</span>
    <span class="kn">import</span> <span class="nn">matplotlib</span>
    <span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>  <span class="c1"># Use non-interactive backend</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">io</span>

    <span class="c1"># Only import GCP storage if config provided</span>
    <span class="k">if</span> <span class="n">storage_config</span><span class="p">:</span>
        <span class="kn">from</span> <span class="nn">google.cloud</span> <span class="kn">import</span> <span class="n">storage</span>

    <span class="k">def</span> <span class="nf">lorenz_system</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lorenz attractor differential equations.&quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">state</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">sigma</span> <span class="o">*</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">),</span>
            <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="n">rho</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span>
            <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">z</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">simulate_lorenz</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">time_points</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simulate Lorenz system with given parameters.&quot;&quot;&quot;</span>
        <span class="n">initial_state</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span>
            <span class="n">lorenz_system</span><span class="p">,</span> <span class="n">initial_state</span><span class="p">,</span> <span class="n">time_points</span><span class="p">,</span>
            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">solution</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Parameter sweep</span>
    <span class="n">parameter_sets</span> <span class="o">=</span> <span class="n">simulation_params</span><span class="p">[</span><span class="s1">&#39;parameter_sets&#39;</span><span class="p">]</span>
    <span class="n">time_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">simulation_params</span><span class="p">[</span><span class="s1">&#39;max_time&#39;</span><span class="p">],</span> <span class="n">simulation_params</span><span class="p">[</span><span class="s1">&#39;num_points&#39;</span><span class="p">])</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameter_sets</span><span class="p">):</span>
        <span class="c1"># Run simulation</span>
        <span class="n">solution</span> <span class="o">=</span> <span class="n">simulate_lorenz</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">time_points</span><span class="p">)</span>

        <span class="c1"># Analyze results</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">solution</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">solution</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">solution</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

        <span class="n">analysis</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;params&#39;</span><span class="p">:</span> <span class="n">params</span><span class="p">,</span>
            <span class="s1">&#39;max_x&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
            <span class="s1">&#39;min_x&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
            <span class="s1">&#39;max_y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
            <span class="s1">&#39;min_y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
            <span class="s1">&#39;max_z&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">z</span><span class="p">)),</span>
            <span class="s1">&#39;min_z&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">z</span><span class="p">)),</span>
            <span class="s1">&#39;mean_energy&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">z</span><span class="o">**</span><span class="mi">2</span><span class="p">)),</span>
            <span class="s1">&#39;final_state&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])],</span>
            <span class="s1">&#39;std_x&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span>
            <span class="s1">&#39;std_y&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
            <span class="s1">&#39;std_z&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
        <span class="p">}</span>

        <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">analysis</span><span class="p">)</span>

        <span class="c1"># Create visualization for first few parameter sets</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

            <span class="c1"># Time series</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Y&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_points</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Z&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;State&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Lorenz System (σ=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;sigma&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, ρ=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;rho&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, β=</span><span class="si">{</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

            <span class="c1"># Phase space (X-Y)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;X-Y Phase Space&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

            <span class="c1"># Phase space (X-Z)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;X-Z Phase Space&#39;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

            <span class="c1"># Save plot to Cloud Storage if configured</span>
            <span class="k">if</span> <span class="n">storage_config</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">img_buffer</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
                    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">img_buffer</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
                    <span class="n">img_buffer</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

                    <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">storage_config</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">])</span>
                    <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="n">storage_config</span><span class="p">[</span><span class="s1">&#39;bucket_name&#39;</span><span class="p">])</span>

                    <span class="n">plot_blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;plots/lorenz_simulation_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">.png&quot;</span><span class="p">)</span>
                    <span class="n">plot_blob</span><span class="o">.</span><span class="n">upload_from_string</span><span class="p">(</span><span class="n">img_buffer</span><span class="o">.</span><span class="n">getvalue</span><span class="p">(),</span> <span class="n">content_type</span><span class="o">=</span><span class="s1">&#39;image/png&#39;</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not save plot to GCS: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="n">computation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="c1"># Calculate summary statistics</span>
    <span class="n">energies</span> <span class="o">=</span> <span class="p">[</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;mean_energy&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
    <span class="n">summary_stats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;total_simulations&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter_sets</span><span class="p">),</span>
        <span class="s1">&#39;computation_time&#39;</span><span class="p">:</span> <span class="n">computation_time</span><span class="p">,</span>
        <span class="s1">&#39;average_energy&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">energies</span><span class="p">),</span>
        <span class="s1">&#39;max_energy&#39;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="n">energies</span><span class="p">),</span>
        <span class="s1">&#39;min_energy&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">energies</span><span class="p">),</span>
        <span class="s1">&#39;energy_std&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">energies</span><span class="p">),</span>
        <span class="s1">&#39;time_per_simulation&#39;</span><span class="p">:</span> <span class="n">computation_time</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter_sets</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1"># Save detailed results to Cloud Storage if configured</span>
    <span class="k">if</span> <span class="n">storage_config</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">storage_client</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="n">Client</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="n">storage_config</span><span class="p">[</span><span class="s1">&#39;project_id&#39;</span><span class="p">])</span>
            <span class="n">bucket</span> <span class="o">=</span> <span class="n">storage_client</span><span class="o">.</span><span class="n">bucket</span><span class="p">(</span><span class="n">storage_config</span><span class="p">[</span><span class="s1">&#39;bucket_name&#39;</span><span class="p">])</span>

            <span class="n">results_blob</span> <span class="o">=</span> <span class="n">bucket</span><span class="o">.</span><span class="n">blob</span><span class="p">(</span><span class="s2">&quot;results/simulation_results.pkl&quot;</span><span class="p">)</span>
            <span class="n">results_data</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;simulation_params&#39;</span><span class="p">:</span> <span class="n">simulation_params</span><span class="p">,</span>
                <span class="s1">&#39;results&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">,</span>
                <span class="s1">&#39;summary_stats&#39;</span><span class="p">:</span> <span class="n">summary_stats</span><span class="p">,</span>
                <span class="s1">&#39;timestamp&#39;</span><span class="p">:</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="p">}</span>
            <span class="n">results_bytes</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">results_data</span><span class="p">)</span>
            <span class="n">results_blob</span><span class="o">.</span><span class="n">upload_from_string</span><span class="p">(</span><span class="n">results_bytes</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: Could not save results to GCS: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;num_simulations&#39;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter_sets</span><span class="p">),</span>
        <span class="s1">&#39;computation_time&#39;</span><span class="p">:</span> <span class="n">computation_time</span><span class="p">,</span>
        <span class="s1">&#39;summary_stats&#39;</span><span class="p">:</span> <span class="n">summary_stats</span><span class="p">,</span>
        <span class="s1">&#39;results_preview&#39;</span><span class="p">:</span> <span class="n">results</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span>  <span class="c1"># First 2 for brevity</span>
        <span class="s1">&#39;storage_location&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;gs://</span><span class="si">{</span><span class="n">storage_config</span><span class="p">[</span><span class="s1">&#39;bucket_name&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">/results/&quot;</span> <span class="k">if</span> <span class="n">storage_config</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;plots_saved&#39;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">parameter_sets</span><span class="p">))</span>
    <span class="p">}</span>

<span class="c1"># Monte Carlo simulation example</span>
<span class="nd">@cluster</span><span class="p">(</span><span class="n">cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">memory</span><span class="o">=</span><span class="s2">&quot;4GB&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gcp_monte_carlo_simulation</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1000000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monte Carlo simulation for option pricing.&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
    <span class="kn">import</span> <span class="nn">time</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

    <span class="c1"># Black-Scholes parameters</span>
    <span class="n">S0</span> <span class="o">=</span> <span class="mi">100</span>    <span class="c1"># Initial stock price</span>
    <span class="n">K</span> <span class="o">=</span> <span class="mi">105</span>     <span class="c1"># Strike price</span>
    <span class="n">T</span> <span class="o">=</span> <span class="mf">1.0</span>     <span class="c1"># Time to expiration</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mf">0.05</span>    <span class="c1"># Risk-free rate</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># Volatility</span>

    <span class="c1"># Generate random samples</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>

    <span class="c1"># Simulate stock prices at expiration</span>
    <span class="n">ST</span> <span class="o">=</span> <span class="n">S0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">r</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">T</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">Z</span><span class="p">)</span>

    <span class="c1"># Calculate option payoffs</span>
    <span class="n">call_payoffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">ST</span> <span class="o">-</span> <span class="n">K</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">put_payoffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">K</span> <span class="o">-</span> <span class="n">ST</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Discount to present value</span>
    <span class="n">call_price</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">call_payoffs</span><span class="p">)</span>
    <span class="n">put_price</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">put_payoffs</span><span class="p">)</span>

    <span class="c1"># Calculate confidence intervals</span>
    <span class="n">call_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">call_payoffs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>
    <span class="n">put_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">put_payoffs</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n_samples</span><span class="p">)</span>

    <span class="n">computation_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;n_samples&#39;</span><span class="p">:</span> <span class="n">n_samples</span><span class="p">,</span>
        <span class="s1">&#39;computation_time&#39;</span><span class="p">:</span> <span class="n">computation_time</span><span class="p">,</span>
        <span class="s1">&#39;call_price&#39;</span><span class="p">:</span> <span class="n">call_price</span><span class="p">,</span>
        <span class="s1">&#39;put_price&#39;</span><span class="p">:</span> <span class="n">put_price</span><span class="p">,</span>
        <span class="s1">&#39;call_confidence_interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">call_price</span> <span class="o">-</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">call_std</span><span class="p">,</span> <span class="n">call_price</span> <span class="o">+</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">call_std</span><span class="p">],</span>
        <span class="s1">&#39;put_confidence_interval&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">put_price</span> <span class="o">-</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">put_std</span><span class="p">,</span> <span class="n">put_price</span> <span class="o">+</span> <span class="mf">1.96</span><span class="o">*</span><span class="n">put_std</span><span class="p">],</span>
        <span class="s1">&#39;parameters&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;S0&#39;</span><span class="p">:</span> <span class="n">S0</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span> <span class="n">K</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span> <span class="n">T</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">:</span> <span class="n">r</span><span class="p">,</span> <span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="n">sigma</span><span class="p">}</span>
    <span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;✓ Advanced scientific computing examples defined&quot;</span><span class="p">)</span>

<span class="c1"># Example simulation parameters</span>
<span class="n">example_lorenz_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;parameter_sets&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">:</span> <span class="mf">28.0</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">},</span>    <span class="c1"># Classic chaotic</span>
        <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">:</span> <span class="mf">24.74</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">},</span>   <span class="c1"># Near onset</span>
        <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">10.0</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">:</span> <span class="mf">99.65</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">8.0</span><span class="o">/</span><span class="mf">3.0</span><span class="p">},</span>   <span class="c1"># High rho</span>
        <span class="p">{</span><span class="s1">&#39;sigma&#39;</span><span class="p">:</span> <span class="mf">16.0</span><span class="p">,</span> <span class="s1">&#39;rho&#39;</span><span class="p">:</span> <span class="mf">45.92</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span> <span class="mf">4.0</span><span class="p">},</span>       <span class="c1"># Different params</span>
    <span class="p">],</span>
    <span class="s1">&#39;max_time&#39;</span><span class="p">:</span> <span class="mf">25.0</span><span class="p">,</span>
    <span class="s1">&#39;num_points&#39;</span><span class="p">:</span> <span class="mi">5000</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📝 Example usage:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# Lorenz simulation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# result = gcp_scientific_simulation(example_lorenz_params)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# print(f&#39;Completed </span><span class="si">{result[\&quot;num_simulations\&quot;]}</span><span class="s2"> simulations&#39;)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# print(f&#39;Computation time: </span><span class="si">{result[\&quot;computation_time\&quot;]:.2f}</span><span class="s2"> seconds&#39;)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# Monte Carlo simulation:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# mc_result = gcp_monte_carlo_simulation(n_samples=5000000)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;# print(f&#39;Call option price: $</span><span class="si">{mc_result[\&quot;call_price\&quot;]:.2f}</span><span class="s2">&#39;)&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🧪 These examples demonstrate GCP&#39;s computational capabilities:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Parallel differential equation solving&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Statistical simulations with confidence intervals&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Cloud Storage integration for results&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  • Visualization generation and storage&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Link to this heading">¶</a></h2>
<p>This tutorial covered:</p>
<ol class="arabic simple">
<li><p><strong>Setup</strong>: GCP authentication and Clustrix installation</p></li>
<li><p><strong>Compute Engine</strong>: Direct VM configuration and management</p></li>
<li><p><strong>GKE Integration</strong>: Kubernetes clusters for containerized workloads</p></li>
<li><p><strong>Cloud Batch</strong>: Managed job scheduling for large-scale processing</p></li>
<li><p><strong>Cloud Storage</strong>: Data management and result storage</p></li>
<li><p><strong>Vertex AI</strong>: Machine learning platform integration</p></li>
<li><p><strong>Security</strong>: Best practices for secure deployment</p></li>
<li><p><strong>Resource Management</strong>: Proper cleanup procedures</p></li>
</ol>
<section id="Cost-Monitoring">
<h3>Cost Monitoring<a class="headerlink" href="#Cost-Monitoring" title="Link to this heading">¶</a></h3>
<p>For comprehensive cost monitoring, optimization strategies, and multi-cloud cost comparisons, see the dedicated <a class="reference internal" href="cost_monitoring_tutorial.html"><span class="doc">Cost Monitoring Tutorial</span></a>.</p>
</section>
<section id="Next-Steps">
<h3>Next Steps<a class="headerlink" href="#Next-Steps" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>Set up your GCP credentials and test the basic configuration</p></li>
<li><p>Start with a simple Compute Engine instance for initial testing</p></li>
<li><p>Consider GKE for containerized workloads and auto-scaling</p></li>
<li><p>Explore Cloud Batch for large-scale batch processing</p></li>
<li><p>Implement proper monitoring and access controls</p></li>
<li><p>Review the Cost Monitoring Tutorial for expense tracking</p></li>
</ul>
</section>
<section id="GCP-Specific-Advantages">
<h3>GCP-Specific Advantages<a class="headerlink" href="#GCP-Specific-Advantages" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><strong>Preemptible/Spot VMs</strong>: Exceptional cost savings (up to 80%)</p></li>
<li><p><strong>Google Kubernetes Engine</strong>: Industry-leading managed Kubernetes</p></li>
<li><p><strong>Vertex AI</strong>: Comprehensive ML platform with AutoML capabilities</p></li>
<li><p><strong>Global Network</strong>: Superior network performance and global reach</p></li>
<li><p><strong>BigQuery Integration</strong>: Seamless data analytics integration</p></li>
<li><p><strong>Sustained Use Discounts</strong>: Automatic discounts for sustained usage</p></li>
</ul>
</section>
<section id="Resources">
<h3>Resources<a class="headerlink" href="#Resources" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://cloud.google.com/compute/docs">Google Cloud Compute Engine Documentation</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/kubernetes-engine/docs">Google Kubernetes Engine Documentation</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/batch/docs">Google Cloud Batch Documentation</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/vertex-ai/docs">Vertex AI Documentation</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/storage/docs">Google Cloud Storage Documentation</a></p></li>
<li><p><a class="reference external" href="https://cloud.google.com/products/calculator">GCP Pricing Calculator</a></p></li>
<li><p><a class="reference external" href="https://clustrix.readthedocs.io/">Clustrix Documentation</a></p></li>
<li><p><a class="reference internal" href="cost_monitoring_tutorial.html"><span class="doc">Clustrix Cost Monitoring Tutorial</span></a></p></li>
</ul>
<p><strong>Remember</strong>: Always monitor your cloud costs and clean up resources when not in use!</p>
</section>
</section>
</section>

</main>
                        <nav aria-label="Page navigation" class="py-4 my-5 clearfix font-weight-bold border-top">
    <a class="float-left" href="azure_cloud_tutorial.html" title="Previous">
        <span aria-hidden="true">←&nbsp;</span>Microsoft Azure Cloud Tutorial
    </a>
    <a class="float-right" href="huggingface_spaces_tutorial.html" title="Next">
        HuggingFace Spaces Tutorial <span aria-hidden="true">&nbsp;→</span>
    </a>
</nav>
                    </div>
                    
                    <nav class="col-12 col-lg-3 pb-4">
                        <div class="sticky-top toc page-toc" aria-labelledby="page-toc-heading">
                            <p class="font-weight-bold" id="page-toc-heading">Page contents</p>
                            <ul>
<li><a class="reference internal" href="#">Google Cloud Platform (GCP) Tutorial</a><ul>
<li><a class="reference internal" href="#Overview">Overview</a></li>
<li><a class="reference internal" href="#Complete-Setup-Guide-from-Scratch">Complete Setup Guide from Scratch</a><ul>
<li><a class="reference internal" href="#Step-1:-Google-Cloud-Account-Setup">Step 1: Google Cloud Account Setup</a></li>
<li><a class="reference internal" href="#Step-2:-Install-Google-Cloud-SDK-(gcloud-CLI)">Step 2: Install Google Cloud SDK (gcloud CLI)</a></li>
<li><a class="reference internal" href="#Step-3:-Enable-Required-APIs">Step 3: Enable Required APIs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Prerequisites-Checklist">Prerequisites Checklist</a></li>
<li><a class="reference internal" href="#Installation-and-Setup">Installation and Setup</a><ul>
<li><a class="reference internal" href="#Step-4:-SSH-Key-Setup">Step 4: SSH Key Setup</a></li>
</ul>
</li>
<li><a class="reference internal" href="#GCP-Authentication-Setup">GCP Authentication Setup</a><ul>
<li><a class="reference internal" href="#Option-1:-gcloud-CLI-Authentication-(Recommended-for-Local-Development)">Option 1: gcloud CLI Authentication (Recommended for Local Development)</a></li>
<li><a class="reference internal" href="#Option-2:-Service-Account-Authentication-(Recommended-for-Production)">Option 2: Service Account Authentication (Recommended for Production)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Method-1:-Google-Compute-Engine-Configuration">Method 1: Google Compute Engine Configuration</a><ul>
<li><a class="reference internal" href="#Create-Compute-Engine-Instance-for-Clustrix">Create Compute Engine Instance for Clustrix</a></li>
<li><a class="reference internal" href="#GCP-Compute-Engine-Instance-Creation">GCP Compute Engine Instance Creation</a></li>
<li><a class="reference internal" href="#Configure-Clustrix-for-Compute-Engine">Configure Clustrix for Compute Engine</a></li>
<li><a class="reference internal" href="#Example:-Remote-Computation-on-Compute-Engine">Example: Remote Computation on Compute Engine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Method-2:-Google-Kubernetes-Engine-(GKE)-Configuration">Method 2: Google Kubernetes Engine (GKE) Configuration</a></li>
<li><a class="reference internal" href="#Method-3:-Google-Cloud-Batch">Method 3: Google Cloud Batch</a></li>
<li><a class="reference internal" href="#Data-Management-with-Google-Cloud-Storage">Data Management with Google Cloud Storage</a></li>
<li><a class="reference internal" href="#Vertex-AI-Integration">Vertex AI Integration</a></li>
<li><a class="reference internal" href="#Security-Best-Practices">Security Best Practices</a><ul>
<li><a class="reference internal" href="#GCP-Security-Checklist-for-Clustrix">GCP Security Checklist for Clustrix</a></li>
</ul>
</li>
<li><a class="reference internal" href="#Resource-Cleanup">Resource Cleanup</a></li>
<li><a class="reference internal" href="#Advanced-Example:-Distributed-Scientific-Computing">Advanced Example: Distributed Scientific Computing</a></li>
<li><a class="reference internal" href="#Summary">Summary</a><ul>
<li><a class="reference internal" href="#Cost-Monitoring">Cost Monitoring</a></li>
<li><a class="reference internal" href="#Next-Steps">Next Steps</a></li>
<li><a class="reference internal" href="#GCP-Specific-Advantages">GCP-Specific Advantages</a></li>
<li><a class="reference internal" href="#Resources">Resources</a></li>
</ul>
</li>
</ul>
</li>
</ul>

                        </div>
                    </nav>
                    
                </div>
            </div>
        </div>
    </div>
    <footer class="container-fluid bg-primary text-light">
        <div class="container">
            <div class="row">
        <div class="col p-4">
            
                <nav aria-label="Footer">
                    <ul class="nav justify-content-center mb-2">
                        
                            
                            
                            <li class="nav-item"><a class="nav-link text-light"  href="PyPI">GitHub</a></li>
                        
                    </ul>
                </nav>
            
            <div class="text-center">
                    &copy; Copyright 2025, Contextual Dynamics Laboratory
            </div>
            <div class="text-center text-white-50 font-italic mt-3">
                <small>Last updated: Jun 27, 2025</small>
                <small>
                    Created using
                    <a class="text-white" href="https://github.com/wagtail/sphinx_wagtail_theme" rel="nofollow" target="_blank">
                        Sphinx Wagtail Theme 6.5.0
                    </a>
                    and
                    <a class="text-white" href="https://www.sphinx-doc.org/" rel="nofollow" target="_blank">
                        Sphinx 8.1.3
                    </a>
                </small>
            </div>
        </div>
    </div>
        </div>
    </footer>
        <script src="../_static/documentation_options.js?v=01f34227"></script>
        <script src="../_static/doctools.js?v=9bcbadda"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
        <script src="../_static/copybutton.js?v=f281be69"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script type="text/javascript" src="../_static/dist/theme.js"></script>
        <script type="text/javascript" src="../_static/dist/vendor.js"></script>
        <script type="text/javascript" src="../_static/searchtools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript">
            document.addEventListener('DOMContentLoaded', function() { Search.loadIndex("../searchindex.js"); });
        </script>
        <script type="text/javascript" id="searchindexloader"></script>
    </body>
</html>